2025-10-26 22:37:11 - agents.nodes.load_context - INFO - --- Entering Load Context Node ---
2025-10-26 22:37:11 - agents.nodes.load_context - INFO - Attempting to load user profile from: C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-7\test_carga_perfil_usuario_exit0\users\test_user.json
2025-10-26 22:37:11 - agents.nodes.load_context - INFO - Successfully loaded profile for user: test_user
2025-10-26 22:37:11 - agents.nodes.load_context - INFO - --- Exiting Load Context Node ---
2025-10-26 22:37:11 - agents.nodes.load_context - INFO - --- Entering Load Context Node ---
2025-10-26 22:37:11 - agents.nodes.load_context - INFO - Attempting to load user profile from: C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-7\test_maneja_usuario_no_encontr0\users\usuario_inexistente.json
2025-10-26 22:37:11 - agents.nodes.load_context - ERROR - User file not found for user_id: usuario_inexistente at C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-7\test_maneja_usuario_no_encontr0\users\usuario_inexistente.json
2025-10-26 22:37:11 - agents.nodes.load_context - INFO - --- Entering Load Context Node ---
2025-10-26 22:37:11 - agents.nodes.load_context - INFO - Attempting to load user profile from: C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-7\test_maneja_json_corrupto0\users\corrupt_user.json
2025-10-26 22:37:11 - agents.nodes.load_context - ERROR - Failed to decode JSON for user corrupt_user: Expecting property name enclosed in double quotes: line 1 column 48 (char 47)
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\load_context.py", line 45, in load_context
    user_profile = json.load(f)
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python313\Lib\json\__init__.py", line 293, in load
    return loads(fp.read(),
        cls=cls, object_hook=object_hook,
        parse_float=parse_float, parse_int=parse_int,
        parse_constant=parse_constant, object_pairs_hook=object_pairs_hook, **kw)
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python313\Lib\json\__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python313\Lib\json\decoder.py", line 345, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python313\Lib\json\decoder.py", line 361, in raw_decode
    obj, end = self.scan_once(s, idx)
               ~~~~~~~~~~~~~~^^^^^^^^
json.decoder.JSONDecodeError: Expecting property name enclosed in double quotes: line 1 column 48 (char 47)
2025-10-26 22:37:11 - agents.nodes.load_context - INFO - --- Exiting Load Context Node ---
2025-10-26 22:37:11 - agents.nodes.load_context - INFO - --- Entering Load Context Node ---
2025-10-26 22:37:11 - agents.nodes.load_context - INFO - Attempting to load user profile from: C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-7\test_maneja_perfil_incompleto0\users\incomplete_user.json
2025-10-26 22:37:11 - agents.nodes.load_context - ERROR - User profile for incomplete_user is incomplete. Missing fields: ['level', 'objetivo']
2025-10-26 22:37:11 - agents.nodes.extract_principles - INFO - --- Entering Extract Principles Node ---
2025-10-26 22:37:11 - agents.nodes.extract_principles - INFO - Initializing PrincipleExtractor...
2025-10-26 22:37:13 - rag.principle_extractor - INFO - PrincipleExtractor initialized.
2025-10-26 22:37:13 - agents.nodes.extract_principles - INFO - Extraction chain obtained. Invoking...
2025-10-26 22:37:13 - agents.nodes.extract_principles - INFO - Successfully extracted principles for user: test_user
2025-10-26 22:37:13 - agents.nodes.extract_principles - INFO - --- Exiting Extract Principles Node ---
2025-10-26 22:37:13 - agents.nodes.extract_principles - INFO - --- Entering Extract Principles Node ---
2025-10-26 22:37:13 - agents.nodes.extract_principles - INFO - Initializing PrincipleExtractor...
2025-10-26 22:37:14 - rag.principle_extractor - INFO - PrincipleExtractor initialized.
2025-10-26 22:37:14 - agents.nodes.extract_principles - INFO - Extraction chain obtained. Invoking...
2025-10-26 22:37:14 - agents.nodes.extract_principles - ERROR - CRITICAL: Extracted principles lack source citations!
2025-10-26 22:37:14 - agents.nodes.extract_principles - ERROR - Error invoking principle extraction chain: 'NoneType' object does not support item assignment
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\extract_principles.py", line 63, in extract_principles
    state["debug_info"]["principles_without_citations"] = principios.model_dump() # Pydantic V2
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: 'NoneType' object does not support item assignment
2025-10-26 22:37:14 - agents.nodes.extract_principles - INFO - --- Exiting Extract Principles Node ---
2025-10-26 22:37:14 - agents.nodes.extract_principles - INFO - --- Entering Extract Principles Node ---
2025-10-26 22:37:14 - agents.nodes.extract_principles - INFO - Initializing PrincipleExtractor...
2025-10-26 22:37:15 - rag.principle_extractor - INFO - PrincipleExtractor initialized.
2025-10-26 22:37:15 - agents.nodes.extract_principles - INFO - Extraction chain obtained. Invoking...
2025-10-26 22:37:15 - agents.nodes.extract_principles - INFO - Successfully extracted principles for user: test_user
2025-10-26 22:37:15 - agents.nodes.extract_principles - INFO - --- Exiting Extract Principles Node ---
2025-10-26 22:37:15 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 22:37:15 - agents.nodes.generate_routine - INFO - Loading routine assembler prompt from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\routine_assembler.txt
2025-10-26 22:37:15 - agents.nodes.generate_routine - INFO - Routine generation chain built.
2025-10-26 22:37:15 - agents.nodes.generate_routine - INFO - Attempt 1/3 to generate routine...
2025-10-26 22:37:15 - agents.nodes.generate_routine - INFO - LLM invocation successful.
2025-10-26 22:37:15 - agents.nodes.generate_routine - INFO - Successfully generated and validated routine in 0.01 seconds.
2025-10-26 22:37:15 - agents.nodes.generate_routine - INFO - --- Exiting Generate Routine Node ---
2025-10-26 22:37:15 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 22:37:15 - agents.nodes.generate_routine - ERROR - 'principios_libro' missing in state.
2025-10-26 22:37:15 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 22:37:15 - agents.nodes.generate_routine - INFO - Loading routine assembler prompt from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\routine_assembler.txt
2025-10-26 22:37:15 - agents.nodes.generate_routine - INFO - Routine generation chain built.
2025-10-26 22:37:15 - agents.nodes.generate_routine - INFO - Attempt 1/3 to generate routine...
2025-10-26 22:37:15 - agents.nodes.generate_routine - ERROR - Attempt 1 failed with unexpected error: LLM Error simulado
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
Exception: LLM Error simulado
2025-10-26 22:37:16 - agents.nodes.generate_routine - INFO - Attempt 2/3 to generate routine...
2025-10-26 22:37:16 - agents.nodes.generate_routine - ERROR - Attempt 2 failed with unexpected error: LLM Error simulado
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
Exception: LLM Error simulado
2025-10-26 22:37:17 - agents.nodes.generate_routine - INFO - Attempt 3/3 to generate routine...
2025-10-26 22:37:17 - agents.nodes.generate_routine - ERROR - Attempt 3 failed with unexpected error: LLM Error simulado
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
Exception: LLM Error simulado
2025-10-26 22:37:18 - agents.nodes.generate_routine - ERROR - Failed to generate valid routine after 3 attempts.
2025-10-26 22:37:18 - agents.nodes.save_routine - INFO - --- Entering Save Routine Node ---
2025-10-26 22:37:18 - agents.nodes.save_routine - INFO - Attempting to save routine for user test_user to C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-7\test_guarda_rutina_exitosament0\users\test_user.json
2025-10-26 22:37:18 - agents.nodes.save_routine - INFO - Created backup at: C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-7\test_guarda_rutina_exitosament0\users\test_user.20251026223718.backup
2025-10-26 22:37:18 - agents.nodes.save_routine - INFO - Successfully wrote updated data to C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-7\test_guarda_rutina_exitosament0\users\test_user.json
2025-10-26 22:37:18 - agents.nodes.save_routine - INFO - Post-write verification passed.
2025-10-26 22:37:18 - agents.nodes.save_routine - INFO - --- Exiting Save Routine Node ---
2025-10-26 22:37:18 - agents.nodes.save_routine - INFO - --- Entering Save Routine Node ---
2025-10-26 22:37:18 - agents.nodes.save_routine - ERROR - 'rutina_final' missing or None in state.
2025-10-26 22:37:18 - agents.nodes.save_routine - INFO - --- Entering Save Routine Node ---
2025-10-26 22:37:18 - agents.nodes.save_routine - INFO - Attempting to save routine for user test_user to C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-7\test_maneja_error_io0\users\test_user.json
2025-10-26 22:37:18 - agents.nodes.save_routine - ERROR - File system error saving routine for test_user: Error de permisos simulado
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\save_routine.py", line 62, in save_routine
    with open(user_file_path, "r", encoding="utf-8") as f:
         ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python313\Lib\unittest\mock.py", line 1169, in __call__
    return self._mock_call(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python313\Lib\unittest\mock.py", line 1173, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python313\Lib\unittest\mock.py", line 1228, in _execute_mock_call
    raise effect
OSError: Error de permisos simulado
2025-10-26 22:37:18 - agents.nodes.save_routine - INFO - --- Exiting Save Routine Node ---
2025-10-26 22:37:18 - agents.nodes.handle_error - INFO - --- Entering Handle Error Node ---
2025-10-26 22:37:18 - agents.nodes.handle_error - ERROR - Error captured in step 'paso_anterior_fallo': Usuario 'xyz' no encontrado
2025-10-26 22:37:18 - agents.nodes.handle_error - INFO - Generated user-friendly error message: ❌ Lo siento, hubo un problema: Ocurrió un error inesperado procesando tu solicitud.
(Referencia: paso 'paso_anterior_fallo')
2025-10-26 22:37:18 - agents.nodes.handle_error - INFO - --- Exiting Handle Error Node ---
2025-10-26 22:37:18 - agents.nodes.handle_error - INFO - --- Entering Handle Error Node ---
2025-10-26 22:37:18 - agents.nodes.handle_error - ERROR - Error captured in step 'paso_anterior_fallo': Archivo corrupto para usuario 'abc': Unterminated string
2025-10-26 22:37:18 - agents.nodes.handle_error - INFO - Generated user-friendly error message: ❌ Lo siento, hubo un problema: Hubo un problema al leer los datos de tu perfil. Podría estar corrupto.
(Referencia: paso 'paso_anterior_fallo')
2025-10-26 22:37:18 - agents.nodes.handle_error - INFO - --- Exiting Handle Error Node ---
2025-10-26 22:37:18 - agents.nodes.handle_error - INFO - --- Entering Handle Error Node ---
2025-10-26 22:37:18 - agents.nodes.handle_error - ERROR - Error captured in step 'paso_anterior_fallo': Alucinación detectada: principios extraídos sin citas
2025-10-26 22:37:18 - agents.nodes.handle_error - INFO - Generated user-friendly error message: ❌ Lo siento, hubo un problema: No pude verificar la información extraída del libro (faltan citas). No puedo proceder de forma segura.
(Referencia: paso 'paso_anterior_fallo')
2025-10-26 22:37:18 - agents.nodes.handle_error - INFO - --- Exiting Handle Error Node ---
2025-10-26 22:37:18 - agents.nodes.handle_error - INFO - --- Entering Handle Error Node ---
2025-10-26 22:37:18 - agents.nodes.handle_error - ERROR - Error captured in step 'paso_anterior_fallo': Validación fallida: RIR inconsistente
2025-10-26 22:37:18 - agents.nodes.handle_error - INFO - Generated user-friendly error message: ❌ Lo siento, hubo un problema: La rutina generada no parece cumplir con los principios o tus preferencias.
(Referencia: paso 'paso_anterior_fallo')
2025-10-26 22:37:18 - agents.nodes.handle_error - INFO - --- Exiting Handle Error Node ---
2025-10-26 22:37:18 - agents.nodes.handle_error - INFO - --- Entering Handle Error Node ---
2025-10-26 22:37:18 - agents.nodes.handle_error - ERROR - Error captured in step 'paso_anterior_fallo': Error de archivo guardando rutina: [Errno 13] Permission denied
2025-10-26 22:37:18 - agents.nodes.handle_error - INFO - Generated user-friendly error message: ❌ Lo siento, hubo un problema: Hubo un problema al intentar guardar la rutina en tu perfil.
(Referencia: paso 'paso_anterior_fallo')
2025-10-26 22:37:18 - agents.nodes.handle_error - INFO - --- Exiting Handle Error Node ---
2025-10-26 22:37:18 - agents.nodes.handle_error - INFO - --- Entering Handle Error Node ---
2025-10-26 22:37:18 - agents.nodes.handle_error - ERROR - Error captured in step 'paso_anterior_fallo': Error desconocido criptográfico
2025-10-26 22:37:18 - agents.nodes.handle_error - INFO - Generated user-friendly error message: ❌ Lo siento, hubo un problema: Ocurrió un error inesperado procesando tu solicitud.
(Referencia: paso 'paso_anterior_fallo')
2025-10-26 22:37:18 - agents.nodes.handle_error - INFO - --- Exiting Handle Error Node ---
2025-10-26 22:37:18 - agents.nodes.load_context - INFO - --- Entering Load Context Node ---
2025-10-26 22:37:18 - agents.nodes.load_context - INFO - Attempting to load user profile from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\data\users\test_user.json
2025-10-26 22:37:18 - agents.nodes.load_context - ERROR - User file not found for user_id: test_user at C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\data\users\test_user.json
2025-10-26 22:37:18 - agents.nodes.handle_error - INFO - --- Entering Handle Error Node ---
2025-10-26 22:37:18 - agents.nodes.handle_error - ERROR - Error captured in step '': Error simulado para prueba de handle_error
2025-10-26 22:37:18 - agents.nodes.handle_error - INFO - Generated user-friendly error message: ❌ Lo siento, hubo un problema: Ocurrió un error inesperado procesando tu solicitud.
(Referencia: paso '')
2025-10-26 22:37:18 - agents.nodes.handle_error - INFO - --- Exiting Handle Error Node ---
2025-10-26 22:43:10 - agents.nodes.load_context - INFO - --- Entering Load Context Node ---
2025-10-26 22:43:10 - agents.nodes.load_context - INFO - Attempting to load user profile from: C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-8\test_carga_perfil_usuario_exit0\users\test_user.json
2025-10-26 22:43:10 - agents.nodes.load_context - INFO - Successfully loaded profile for user: test_user
2025-10-26 22:43:10 - agents.nodes.load_context - INFO - --- Exiting Load Context Node ---
2025-10-26 22:43:10 - agents.nodes.load_context - INFO - --- Entering Load Context Node ---
2025-10-26 22:43:10 - agents.nodes.load_context - INFO - Attempting to load user profile from: C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-8\test_maneja_usuario_no_encontr0\users\usuario_inexistente.json
2025-10-26 22:43:10 - agents.nodes.load_context - ERROR - User file not found for user_id: usuario_inexistente at C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-8\test_maneja_usuario_no_encontr0\users\usuario_inexistente.json
2025-10-26 22:43:10 - agents.nodes.load_context - INFO - --- Entering Load Context Node ---
2025-10-26 22:43:10 - agents.nodes.load_context - INFO - Attempting to load user profile from: C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-8\test_maneja_json_corrupto0\users\corrupt_user.json
2025-10-26 22:43:10 - agents.nodes.load_context - ERROR - Failed to decode JSON for user corrupt_user: Expecting property name enclosed in double quotes: line 1 column 48 (char 47)
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\load_context.py", line 45, in load_context
    user_profile = json.load(f)
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python313\Lib\json\__init__.py", line 293, in load
    return loads(fp.read(),
        cls=cls, object_hook=object_hook,
        parse_float=parse_float, parse_int=parse_int,
        parse_constant=parse_constant, object_pairs_hook=object_pairs_hook, **kw)
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python313\Lib\json\__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python313\Lib\json\decoder.py", line 345, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python313\Lib\json\decoder.py", line 361, in raw_decode
    obj, end = self.scan_once(s, idx)
               ~~~~~~~~~~~~~~^^^^^^^^
json.decoder.JSONDecodeError: Expecting property name enclosed in double quotes: line 1 column 48 (char 47)
2025-10-26 22:43:10 - agents.nodes.load_context - INFO - --- Exiting Load Context Node ---
2025-10-26 22:43:10 - agents.nodes.load_context - INFO - --- Entering Load Context Node ---
2025-10-26 22:43:10 - agents.nodes.load_context - INFO - Attempting to load user profile from: C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-8\test_maneja_perfil_incompleto0\users\incomplete_user.json
2025-10-26 22:43:10 - agents.nodes.load_context - ERROR - User profile for incomplete_user is incomplete. Missing fields: ['level', 'objetivo']
2025-10-26 22:43:10 - agents.nodes.extract_principles - INFO - --- Entering Extract Principles Node ---
2025-10-26 22:43:10 - agents.nodes.extract_principles - INFO - Initializing PrincipleExtractor...
2025-10-26 22:43:12 - rag.principle_extractor - INFO - PrincipleExtractor initialized.
2025-10-26 22:43:12 - agents.nodes.extract_principles - INFO - Extraction chain obtained. Invoking...
2025-10-26 22:43:12 - agents.nodes.extract_principles - INFO - Successfully extracted principles for user: test_user
2025-10-26 22:43:12 - agents.nodes.extract_principles - INFO - --- Exiting Extract Principles Node ---
2025-10-26 22:43:12 - agents.nodes.extract_principles - INFO - --- Entering Extract Principles Node ---
2025-10-26 22:43:12 - agents.nodes.extract_principles - INFO - Initializing PrincipleExtractor...
2025-10-26 22:43:13 - rag.principle_extractor - INFO - PrincipleExtractor initialized.
2025-10-26 22:43:13 - agents.nodes.extract_principles - INFO - Extraction chain obtained. Invoking...
2025-10-26 22:43:13 - agents.nodes.extract_principles - ERROR - CRITICAL: Extracted principles lack source citations!
2025-10-26 22:43:13 - agents.nodes.extract_principles - INFO - --- Entering Extract Principles Node ---
2025-10-26 22:43:13 - agents.nodes.extract_principles - INFO - Initializing PrincipleExtractor...
2025-10-26 22:43:14 - rag.principle_extractor - INFO - PrincipleExtractor initialized.
2025-10-26 22:43:14 - agents.nodes.extract_principles - INFO - Extraction chain obtained. Invoking...
2025-10-26 22:43:14 - agents.nodes.extract_principles - INFO - Successfully extracted principles for user: test_user
2025-10-26 22:43:14 - agents.nodes.extract_principles - INFO - --- Exiting Extract Principles Node ---
2025-10-26 22:43:14 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 22:43:14 - agents.nodes.generate_routine - INFO - Loading routine assembler prompt from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\routine_assembler.txt
2025-10-26 22:43:14 - agents.nodes.generate_routine - INFO - Routine generation chain built.
2025-10-26 22:43:14 - agents.nodes.generate_routine - INFO - Attempt 1/3 to generate routine...
2025-10-26 22:43:14 - agents.nodes.generate_routine - INFO - LLM invocation successful.
2025-10-26 22:43:14 - agents.nodes.generate_routine - INFO - Successfully generated and validated routine in 0.01 seconds.
2025-10-26 22:43:14 - agents.nodes.generate_routine - INFO - --- Exiting Generate Routine Node ---
2025-10-26 22:43:14 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 22:43:14 - agents.nodes.generate_routine - ERROR - 'principios_libro' missing in state.
2025-10-26 22:43:14 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 22:43:14 - agents.nodes.generate_routine - INFO - Loading routine assembler prompt from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\routine_assembler.txt
2025-10-26 22:43:14 - agents.nodes.generate_routine - INFO - Routine generation chain built.
2025-10-26 22:43:14 - agents.nodes.generate_routine - INFO - Attempt 1/3 to generate routine...
2025-10-26 22:43:14 - agents.nodes.generate_routine - ERROR - Attempt 1 failed with unexpected error: LLM Error simulado
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
Exception: LLM Error simulado
2025-10-26 22:43:15 - agents.nodes.generate_routine - INFO - Attempt 2/3 to generate routine...
2025-10-26 22:43:15 - agents.nodes.generate_routine - ERROR - Attempt 2 failed with unexpected error: LLM Error simulado
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
Exception: LLM Error simulado
2025-10-26 22:43:16 - agents.nodes.generate_routine - INFO - Attempt 3/3 to generate routine...
2025-10-26 22:43:16 - agents.nodes.generate_routine - ERROR - Attempt 3 failed with unexpected error: LLM Error simulado
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
Exception: LLM Error simulado
2025-10-26 22:43:17 - agents.nodes.generate_routine - ERROR - Failed to generate valid routine after 3 attempts.
2025-10-26 22:43:17 - agents.nodes.save_routine - INFO - --- Entering Save Routine Node ---
2025-10-26 22:43:17 - agents.nodes.save_routine - INFO - Attempting to save routine for user test_user to C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-8\test_guarda_rutina_exitosament0\users\test_user.json
2025-10-26 22:43:17 - agents.nodes.save_routine - INFO - Created backup at: C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-8\test_guarda_rutina_exitosament0\users\test_user.20251026224317.backup
2025-10-26 22:43:17 - agents.nodes.save_routine - INFO - Successfully wrote updated data to C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-8\test_guarda_rutina_exitosament0\users\test_user.json
2025-10-26 22:43:17 - agents.nodes.save_routine - INFO - Post-write verification passed.
2025-10-26 22:43:17 - agents.nodes.save_routine - INFO - --- Exiting Save Routine Node ---
2025-10-26 22:43:17 - agents.nodes.save_routine - INFO - --- Entering Save Routine Node ---
2025-10-26 22:43:17 - agents.nodes.save_routine - ERROR - 'rutina_final' missing or None in state.
2025-10-26 22:43:17 - agents.nodes.save_routine - INFO - --- Entering Save Routine Node ---
2025-10-26 22:43:17 - agents.nodes.save_routine - INFO - Attempting to save routine for user test_user to C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-8\test_maneja_error_io0\users\test_user.json
2025-10-26 22:43:17 - agents.nodes.save_routine - ERROR - File system error saving routine for test_user: Error de permisos simulado
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\save_routine.py", line 62, in save_routine
    with open(user_file_path, "r", encoding="utf-8") as f:
         ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python313\Lib\unittest\mock.py", line 1169, in __call__
    return self._mock_call(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python313\Lib\unittest\mock.py", line 1173, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python313\Lib\unittest\mock.py", line 1228, in _execute_mock_call
    raise effect
OSError: Error de permisos simulado
2025-10-26 22:43:17 - agents.nodes.save_routine - INFO - --- Exiting Save Routine Node ---
2025-10-26 22:43:17 - agents.nodes.handle_error - INFO - --- Entering Handle Error Node ---
2025-10-26 22:43:17 - agents.nodes.handle_error - ERROR - Error captured in step 'paso_anterior_fallo': Usuario 'xyz' no encontrado
2025-10-26 22:43:17 - agents.nodes.handle_error - INFO - Generated user-friendly error message: ❌ Lo siento, hubo un problema: Ocurrió un error inesperado procesando tu solicitud.
(Referencia: paso 'paso_anterior_fallo')
2025-10-26 22:43:17 - agents.nodes.handle_error - INFO - --- Exiting Handle Error Node ---
2025-10-26 22:43:17 - agents.nodes.handle_error - INFO - --- Entering Handle Error Node ---
2025-10-26 22:43:17 - agents.nodes.handle_error - ERROR - Error captured in step 'paso_anterior_fallo': Archivo corrupto para usuario 'abc': Unterminated string
2025-10-26 22:43:17 - agents.nodes.handle_error - INFO - Generated user-friendly error message: ❌ Lo siento, hubo un problema: Hubo un problema al leer los datos de tu perfil. Podría estar corrupto.
(Referencia: paso 'paso_anterior_fallo')
2025-10-26 22:43:17 - agents.nodes.handle_error - INFO - --- Exiting Handle Error Node ---
2025-10-26 22:43:17 - agents.nodes.handle_error - INFO - --- Entering Handle Error Node ---
2025-10-26 22:43:17 - agents.nodes.handle_error - ERROR - Error captured in step 'paso_anterior_fallo': Alucinación detectada: principios extraídos sin citas
2025-10-26 22:43:17 - agents.nodes.handle_error - INFO - Generated user-friendly error message: ❌ Lo siento, hubo un problema: No pude verificar la información extraída del libro (faltan citas). No puedo proceder de forma segura.
(Referencia: paso 'paso_anterior_fallo')
2025-10-26 22:43:17 - agents.nodes.handle_error - INFO - --- Exiting Handle Error Node ---
2025-10-26 22:43:17 - agents.nodes.handle_error - INFO - --- Entering Handle Error Node ---
2025-10-26 22:43:17 - agents.nodes.handle_error - ERROR - Error captured in step 'paso_anterior_fallo': Validación fallida: RIR inconsistente
2025-10-26 22:43:17 - agents.nodes.handle_error - INFO - Generated user-friendly error message: ❌ Lo siento, hubo un problema: La rutina generada no parece cumplir con los principios o tus preferencias.
(Referencia: paso 'paso_anterior_fallo')
2025-10-26 22:43:17 - agents.nodes.handle_error - INFO - --- Exiting Handle Error Node ---
2025-10-26 22:43:17 - agents.nodes.handle_error - INFO - --- Entering Handle Error Node ---
2025-10-26 22:43:17 - agents.nodes.handle_error - ERROR - Error captured in step 'paso_anterior_fallo': Error de archivo guardando rutina: [Errno 13] Permission denied
2025-10-26 22:43:17 - agents.nodes.handle_error - INFO - Generated user-friendly error message: ❌ Lo siento, hubo un problema: Hubo un problema al intentar guardar la rutina en tu perfil.
(Referencia: paso 'paso_anterior_fallo')
2025-10-26 22:43:17 - agents.nodes.handle_error - INFO - --- Exiting Handle Error Node ---
2025-10-26 22:43:17 - agents.nodes.handle_error - INFO - --- Entering Handle Error Node ---
2025-10-26 22:43:17 - agents.nodes.handle_error - ERROR - Error captured in step 'paso_anterior_fallo': Error desconocido criptográfico
2025-10-26 22:43:17 - agents.nodes.handle_error - INFO - Generated user-friendly error message: ❌ Lo siento, hubo un problema: Ocurrió un error inesperado procesando tu solicitud.
(Referencia: paso 'paso_anterior_fallo')
2025-10-26 22:43:17 - agents.nodes.handle_error - INFO - --- Exiting Handle Error Node ---
2025-10-26 22:43:17 - agents.nodes.load_context - INFO - --- Entering Load Context Node ---
2025-10-26 22:43:17 - agents.nodes.load_context - INFO - Attempting to load user profile from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\data\users\test_user.json
2025-10-26 22:43:17 - agents.nodes.load_context - ERROR - User file not found for user_id: test_user at C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\data\users\test_user.json
2025-10-26 22:43:17 - agents.nodes.handle_error - INFO - --- Entering Handle Error Node ---
2025-10-26 22:43:17 - agents.nodes.handle_error - ERROR - Error captured in step '': Error simulado para prueba de handle_error
2025-10-26 22:43:17 - agents.nodes.handle_error - INFO - Generated user-friendly error message: ❌ Lo siento, hubo un problema: Ocurrió un error inesperado procesando tu solicitud.
(Referencia: paso '')
2025-10-26 22:43:17 - agents.nodes.handle_error - INFO - --- Exiting Handle Error Node ---
2025-10-26 22:46:09 - agents.nodes.load_context - INFO - --- Entering Load Context Node ---
2025-10-26 22:46:09 - agents.nodes.load_context - INFO - Attempting to load user profile from: C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-9\test_carga_perfil_usuario_exit0\users\test_user.json
2025-10-26 22:46:09 - agents.nodes.load_context - INFO - Successfully loaded profile for user: test_user
2025-10-26 22:46:09 - agents.nodes.load_context - INFO - --- Exiting Load Context Node ---
2025-10-26 22:46:09 - agents.nodes.load_context - INFO - --- Entering Load Context Node ---
2025-10-26 22:46:09 - agents.nodes.load_context - INFO - Attempting to load user profile from: C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-9\test_maneja_usuario_no_encontr0\users\usuario_inexistente.json
2025-10-26 22:46:09 - agents.nodes.load_context - ERROR - User file not found for user_id: usuario_inexistente at C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-9\test_maneja_usuario_no_encontr0\users\usuario_inexistente.json
2025-10-26 22:46:09 - agents.nodes.load_context - INFO - --- Entering Load Context Node ---
2025-10-26 22:46:09 - agents.nodes.load_context - INFO - Attempting to load user profile from: C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-9\test_maneja_json_corrupto0\users\corrupt_user.json
2025-10-26 22:46:09 - agents.nodes.load_context - ERROR - Failed to decode JSON for user corrupt_user: Expecting property name enclosed in double quotes: line 1 column 48 (char 47)
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\load_context.py", line 45, in load_context
    user_profile = json.load(f)
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python313\Lib\json\__init__.py", line 293, in load
    return loads(fp.read(),
        cls=cls, object_hook=object_hook,
        parse_float=parse_float, parse_int=parse_int,
        parse_constant=parse_constant, object_pairs_hook=object_pairs_hook, **kw)
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python313\Lib\json\__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python313\Lib\json\decoder.py", line 345, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python313\Lib\json\decoder.py", line 361, in raw_decode
    obj, end = self.scan_once(s, idx)
               ~~~~~~~~~~~~~~^^^^^^^^
json.decoder.JSONDecodeError: Expecting property name enclosed in double quotes: line 1 column 48 (char 47)
2025-10-26 22:46:09 - agents.nodes.load_context - INFO - --- Exiting Load Context Node ---
2025-10-26 22:46:09 - agents.nodes.load_context - INFO - --- Entering Load Context Node ---
2025-10-26 22:46:09 - agents.nodes.load_context - INFO - Attempting to load user profile from: C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-9\test_maneja_perfil_incompleto0\users\incomplete_user.json
2025-10-26 22:46:09 - agents.nodes.load_context - ERROR - User profile for incomplete_user is incomplete. Missing fields: ['level', 'objetivo']
2025-10-26 22:46:09 - agents.nodes.extract_principles - INFO - --- Entering Extract Principles Node ---
2025-10-26 22:46:09 - agents.nodes.extract_principles - INFO - Initializing PrincipleExtractor...
2025-10-26 22:46:11 - rag.principle_extractor - INFO - PrincipleExtractor initialized.
2025-10-26 22:46:11 - agents.nodes.extract_principles - INFO - Extraction chain obtained. Invoking...
2025-10-26 22:46:11 - agents.nodes.extract_principles - INFO - Successfully extracted principles for user: test_user
2025-10-26 22:46:11 - agents.nodes.extract_principles - INFO - --- Exiting Extract Principles Node ---
2025-10-26 22:46:11 - agents.nodes.extract_principles - INFO - --- Entering Extract Principles Node ---
2025-10-26 22:46:11 - agents.nodes.extract_principles - INFO - Initializing PrincipleExtractor...
2025-10-26 22:46:12 - rag.principle_extractor - INFO - PrincipleExtractor initialized.
2025-10-26 22:46:12 - agents.nodes.extract_principles - INFO - Extraction chain obtained. Invoking...
2025-10-26 22:46:12 - agents.nodes.extract_principles - ERROR - CRITICAL: Extracted principles lack source citations!
2025-10-26 22:46:12 - agents.nodes.extract_principles - INFO - --- Entering Extract Principles Node ---
2025-10-26 22:46:12 - agents.nodes.extract_principles - INFO - Initializing PrincipleExtractor...
2025-10-26 22:46:12 - rag.principle_extractor - INFO - PrincipleExtractor initialized.
2025-10-26 22:46:12 - agents.nodes.extract_principles - INFO - Extraction chain obtained. Invoking...
2025-10-26 22:46:12 - agents.nodes.extract_principles - INFO - Successfully extracted principles for user: test_user
2025-10-26 22:46:12 - agents.nodes.extract_principles - INFO - --- Exiting Extract Principles Node ---
2025-10-26 22:46:12 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 22:46:12 - agents.nodes.generate_routine - INFO - Loading routine assembler prompt from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\routine_assembler.txt
2025-10-26 22:46:12 - agents.nodes.generate_routine - INFO - Routine generation chain built.
2025-10-26 22:46:12 - agents.nodes.generate_routine - INFO - Attempt 1/3 to generate routine...
2025-10-26 22:46:12 - agents.nodes.generate_routine - INFO - LLM invocation successful.
2025-10-26 22:46:12 - agents.nodes.generate_routine - INFO - Successfully generated and validated routine in 0.01 seconds.
2025-10-26 22:46:12 - agents.nodes.generate_routine - INFO - --- Exiting Generate Routine Node ---
2025-10-26 22:46:12 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 22:46:12 - agents.nodes.generate_routine - ERROR - 'principios_libro' missing in state.
2025-10-26 22:46:12 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 22:46:12 - agents.nodes.generate_routine - INFO - Loading routine assembler prompt from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\routine_assembler.txt
2025-10-26 22:46:12 - agents.nodes.generate_routine - INFO - Routine generation chain built.
2025-10-26 22:46:12 - agents.nodes.generate_routine - INFO - Attempt 1/3 to generate routine...
2025-10-26 22:46:12 - agents.nodes.generate_routine - ERROR - Attempt 1 failed with unexpected error: LLM Error simulado
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
Exception: LLM Error simulado
2025-10-26 22:46:13 - agents.nodes.generate_routine - INFO - Attempt 2/3 to generate routine...
2025-10-26 22:46:13 - agents.nodes.generate_routine - ERROR - Attempt 2 failed with unexpected error: LLM Error simulado
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
Exception: LLM Error simulado
2025-10-26 22:46:14 - agents.nodes.generate_routine - INFO - Attempt 3/3 to generate routine...
2025-10-26 22:46:14 - agents.nodes.generate_routine - ERROR - Attempt 3 failed with unexpected error: LLM Error simulado
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
Exception: LLM Error simulado
2025-10-26 22:46:15 - agents.nodes.generate_routine - ERROR - Failed to generate valid routine after 3 attempts.
2025-10-26 22:46:15 - agents.nodes.save_routine - INFO - --- Entering Save Routine Node ---
2025-10-26 22:46:15 - agents.nodes.save_routine - INFO - Attempting to save routine for user test_user to C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-9\test_guarda_rutina_exitosament0\users\test_user.json
2025-10-26 22:46:15 - agents.nodes.save_routine - INFO - Created backup at: C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-9\test_guarda_rutina_exitosament0\users\test_user.20251026224615.backup
2025-10-26 22:46:15 - agents.nodes.save_routine - INFO - Successfully wrote updated data to C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-9\test_guarda_rutina_exitosament0\users\test_user.json
2025-10-26 22:46:16 - agents.nodes.save_routine - INFO - Post-write verification passed.
2025-10-26 22:46:16 - agents.nodes.save_routine - INFO - --- Exiting Save Routine Node ---
2025-10-26 22:46:16 - agents.nodes.save_routine - INFO - --- Entering Save Routine Node ---
2025-10-26 22:46:16 - agents.nodes.save_routine - ERROR - 'rutina_final' missing or None in state.
2025-10-26 22:46:16 - agents.nodes.save_routine - INFO - --- Entering Save Routine Node ---
2025-10-26 22:46:16 - agents.nodes.save_routine - INFO - Attempting to save routine for user test_user to C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-9\test_maneja_error_io0\users\test_user.json
2025-10-26 22:46:16 - agents.nodes.save_routine - ERROR - File system error saving routine for test_user: Error de permisos simulado
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\save_routine.py", line 62, in save_routine
    with open(user_file_path, "r", encoding="utf-8") as f:
         ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python313\Lib\unittest\mock.py", line 1169, in __call__
    return self._mock_call(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python313\Lib\unittest\mock.py", line 1173, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python313\Lib\unittest\mock.py", line 1228, in _execute_mock_call
    raise effect
OSError: Error de permisos simulado
2025-10-26 22:46:16 - agents.nodes.save_routine - INFO - --- Exiting Save Routine Node ---
2025-10-26 22:46:16 - agents.nodes.handle_error - INFO - --- Entering Handle Error Node ---
2025-10-26 22:46:16 - agents.nodes.handle_error - ERROR - Error captured in step 'paso_anterior_fallo': Usuario 'xyz' no encontrado
2025-10-26 22:46:16 - agents.nodes.handle_error - INFO - Generated user-friendly error message: ❌ Lo siento, hubo un problema: Ocurrió un error inesperado procesando tu solicitud.
(Referencia: paso 'paso_anterior_fallo')
2025-10-26 22:46:16 - agents.nodes.handle_error - INFO - --- Exiting Handle Error Node ---
2025-10-26 22:46:16 - agents.nodes.handle_error - INFO - --- Entering Handle Error Node ---
2025-10-26 22:46:16 - agents.nodes.handle_error - ERROR - Error captured in step 'paso_anterior_fallo': Archivo corrupto para usuario 'abc': Unterminated string
2025-10-26 22:46:16 - agents.nodes.handle_error - INFO - Generated user-friendly error message: ❌ Lo siento, hubo un problema: Hubo un problema al leer los datos de tu perfil. Podría estar corrupto.
(Referencia: paso 'paso_anterior_fallo')
2025-10-26 22:46:16 - agents.nodes.handle_error - INFO - --- Exiting Handle Error Node ---
2025-10-26 22:46:16 - agents.nodes.handle_error - INFO - --- Entering Handle Error Node ---
2025-10-26 22:46:16 - agents.nodes.handle_error - ERROR - Error captured in step 'paso_anterior_fallo': Alucinación detectada: principios extraídos sin citas
2025-10-26 22:46:16 - agents.nodes.handle_error - INFO - Generated user-friendly error message: ❌ Lo siento, hubo un problema: No pude verificar la información extraída del libro (faltan citas). No puedo proceder de forma segura.
(Referencia: paso 'paso_anterior_fallo')
2025-10-26 22:46:16 - agents.nodes.handle_error - INFO - --- Exiting Handle Error Node ---
2025-10-26 22:46:16 - agents.nodes.handle_error - INFO - --- Entering Handle Error Node ---
2025-10-26 22:46:16 - agents.nodes.handle_error - ERROR - Error captured in step 'paso_anterior_fallo': Validación fallida: RIR inconsistente
2025-10-26 22:46:16 - agents.nodes.handle_error - INFO - Generated user-friendly error message: ❌ Lo siento, hubo un problema: La rutina generada no parece cumplir con los principios o tus preferencias.
(Referencia: paso 'paso_anterior_fallo')
2025-10-26 22:46:16 - agents.nodes.handle_error - INFO - --- Exiting Handle Error Node ---
2025-10-26 22:46:16 - agents.nodes.handle_error - INFO - --- Entering Handle Error Node ---
2025-10-26 22:46:16 - agents.nodes.handle_error - ERROR - Error captured in step 'paso_anterior_fallo': Error de archivo guardando rutina: [Errno 13] Permission denied
2025-10-26 22:46:16 - agents.nodes.handle_error - INFO - Generated user-friendly error message: ❌ Lo siento, hubo un problema: Hubo un problema al intentar guardar la rutina en tu perfil.
(Referencia: paso 'paso_anterior_fallo')
2025-10-26 22:46:16 - agents.nodes.handle_error - INFO - --- Exiting Handle Error Node ---
2025-10-26 22:46:16 - agents.nodes.handle_error - INFO - --- Entering Handle Error Node ---
2025-10-26 22:46:16 - agents.nodes.handle_error - ERROR - Error captured in step 'paso_anterior_fallo': Error desconocido criptográfico
2025-10-26 22:46:16 - agents.nodes.handle_error - INFO - Generated user-friendly error message: ❌ Lo siento, hubo un problema: Ocurrió un error inesperado procesando tu solicitud.
(Referencia: paso 'paso_anterior_fallo')
2025-10-26 22:46:16 - agents.nodes.handle_error - INFO - --- Exiting Handle Error Node ---
2025-10-26 22:46:16 - agents.nodes.load_context - INFO - --- Entering Load Context Node ---
2025-10-26 22:46:16 - agents.nodes.load_context - INFO - Attempting to load user profile from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\data\users\test_user.json
2025-10-26 22:46:16 - agents.nodes.load_context - ERROR - User file not found for user_id: test_user at C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\data\users\test_user.json
2025-10-26 22:46:16 - agents.nodes.handle_error - INFO - --- Entering Handle Error Node ---
2025-10-26 22:46:16 - agents.nodes.handle_error - ERROR - Error captured in step '': Error simulado para prueba de handle_error
2025-10-26 22:46:16 - agents.nodes.handle_error - INFO - Generated user-friendly error message: ❌ Lo siento, hubo un problema: Ocurrió un error inesperado procesando tu solicitud.
(Referencia: paso '')
2025-10-26 22:46:16 - agents.nodes.handle_error - INFO - --- Exiting Handle Error Node ---
2025-10-26 22:47:19 - agents.nodes.load_context - INFO - --- Entering Load Context Node ---
2025-10-26 22:47:19 - agents.nodes.load_context - INFO - Attempting to load user profile from: C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-10\test_carga_perfil_usuario_exit0\users\test_user.json
2025-10-26 22:47:19 - agents.nodes.load_context - INFO - Successfully loaded profile for user: test_user
2025-10-26 22:47:19 - agents.nodes.load_context - INFO - --- Exiting Load Context Node ---
2025-10-26 22:47:19 - agents.nodes.load_context - INFO - --- Entering Load Context Node ---
2025-10-26 22:47:19 - agents.nodes.load_context - INFO - Attempting to load user profile from: C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-10\test_maneja_usuario_no_encontr0\users\usuario_inexistente.json
2025-10-26 22:47:19 - agents.nodes.load_context - ERROR - User file not found for user_id: usuario_inexistente at C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-10\test_maneja_usuario_no_encontr0\users\usuario_inexistente.json
2025-10-26 22:47:19 - agents.nodes.load_context - INFO - --- Entering Load Context Node ---
2025-10-26 22:47:19 - agents.nodes.load_context - INFO - Attempting to load user profile from: C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-10\test_maneja_json_corrupto0\users\corrupt_user.json
2025-10-26 22:47:19 - agents.nodes.load_context - ERROR - Failed to decode JSON for user corrupt_user: Expecting property name enclosed in double quotes: line 1 column 48 (char 47)
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\load_context.py", line 45, in load_context
    user_profile = json.load(f)
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python313\Lib\json\__init__.py", line 293, in load
    return loads(fp.read(),
        cls=cls, object_hook=object_hook,
        parse_float=parse_float, parse_int=parse_int,
        parse_constant=parse_constant, object_pairs_hook=object_pairs_hook, **kw)
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python313\Lib\json\__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python313\Lib\json\decoder.py", line 345, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python313\Lib\json\decoder.py", line 361, in raw_decode
    obj, end = self.scan_once(s, idx)
               ~~~~~~~~~~~~~~^^^^^^^^
json.decoder.JSONDecodeError: Expecting property name enclosed in double quotes: line 1 column 48 (char 47)
2025-10-26 22:47:19 - agents.nodes.load_context - INFO - --- Exiting Load Context Node ---
2025-10-26 22:47:19 - agents.nodes.load_context - INFO - --- Entering Load Context Node ---
2025-10-26 22:47:19 - agents.nodes.load_context - INFO - Attempting to load user profile from: C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-10\test_maneja_perfil_incompleto0\users\incomplete_user.json
2025-10-26 22:47:19 - agents.nodes.load_context - ERROR - User profile for incomplete_user is incomplete. Missing fields: ['level', 'objetivo']
2025-10-26 22:47:19 - agents.nodes.extract_principles - INFO - --- Entering Extract Principles Node ---
2025-10-26 22:47:19 - agents.nodes.extract_principles - INFO - Initializing PrincipleExtractor...
2025-10-26 22:47:21 - rag.principle_extractor - INFO - PrincipleExtractor initialized.
2025-10-26 22:47:21 - agents.nodes.extract_principles - INFO - Extraction chain obtained. Invoking...
2025-10-26 22:47:21 - agents.nodes.extract_principles - INFO - Successfully extracted principles for user: test_user
2025-10-26 22:47:21 - agents.nodes.extract_principles - INFO - --- Exiting Extract Principles Node ---
2025-10-26 22:47:21 - agents.nodes.extract_principles - INFO - --- Entering Extract Principles Node ---
2025-10-26 22:47:21 - agents.nodes.extract_principles - INFO - Initializing PrincipleExtractor...
2025-10-26 22:47:22 - rag.principle_extractor - INFO - PrincipleExtractor initialized.
2025-10-26 22:47:22 - agents.nodes.extract_principles - INFO - Extraction chain obtained. Invoking...
2025-10-26 22:47:22 - agents.nodes.extract_principles - ERROR - CRITICAL: Extracted principles lack source citations!
2025-10-26 22:47:22 - agents.nodes.extract_principles - INFO - --- Entering Extract Principles Node ---
2025-10-26 22:47:22 - agents.nodes.extract_principles - INFO - Initializing PrincipleExtractor...
2025-10-26 22:47:23 - rag.principle_extractor - INFO - PrincipleExtractor initialized.
2025-10-26 22:47:23 - agents.nodes.extract_principles - INFO - Extraction chain obtained. Invoking...
2025-10-26 22:47:23 - agents.nodes.extract_principles - INFO - Successfully extracted principles for user: test_user
2025-10-26 22:47:23 - agents.nodes.extract_principles - INFO - --- Exiting Extract Principles Node ---
2025-10-26 22:47:23 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 22:47:23 - agents.nodes.generate_routine - INFO - Loading routine assembler prompt from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\routine_assembler.txt
2025-10-26 22:47:23 - agents.nodes.generate_routine - INFO - Routine generation chain built.
2025-10-26 22:47:23 - agents.nodes.generate_routine - INFO - Attempt 1/3 to generate routine...
2025-10-26 22:47:23 - agents.nodes.generate_routine - INFO - LLM invocation successful.
2025-10-26 22:47:23 - agents.nodes.generate_routine - INFO - Successfully generated and validated routine in 0.01 seconds.
2025-10-26 22:47:23 - agents.nodes.generate_routine - INFO - --- Exiting Generate Routine Node ---
2025-10-26 22:47:23 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 22:47:23 - agents.nodes.generate_routine - ERROR - 'principios_libro' missing in state.
2025-10-26 22:47:23 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 22:47:23 - agents.nodes.generate_routine - INFO - Loading routine assembler prompt from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\routine_assembler.txt
2025-10-26 22:47:23 - agents.nodes.generate_routine - INFO - Routine generation chain built.
2025-10-26 22:47:23 - agents.nodes.generate_routine - INFO - Attempt 1/3 to generate routine...
2025-10-26 22:47:23 - agents.nodes.generate_routine - ERROR - Attempt 1 failed with unexpected error: LLM Error simulado
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
Exception: LLM Error simulado
2025-10-26 22:47:24 - agents.nodes.generate_routine - INFO - Attempt 2/3 to generate routine...
2025-10-26 22:47:24 - agents.nodes.generate_routine - ERROR - Attempt 2 failed with unexpected error: LLM Error simulado
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
Exception: LLM Error simulado
2025-10-26 22:47:25 - agents.nodes.generate_routine - INFO - Attempt 3/3 to generate routine...
2025-10-26 22:47:25 - agents.nodes.generate_routine - ERROR - Attempt 3 failed with unexpected error: LLM Error simulado
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
Exception: LLM Error simulado
2025-10-26 22:47:26 - agents.nodes.generate_routine - ERROR - Failed to generate valid routine after 3 attempts.
2025-10-26 22:47:26 - agents.nodes.save_routine - INFO - --- Entering Save Routine Node ---
2025-10-26 22:47:26 - agents.nodes.save_routine - INFO - Attempting to save routine for user test_user to C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-10\test_guarda_rutina_exitosament0\users\test_user.json
2025-10-26 22:47:26 - agents.nodes.save_routine - INFO - Created backup at: C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-10\test_guarda_rutina_exitosament0\users\test_user.20251026224726.backup
2025-10-26 22:47:26 - agents.nodes.save_routine - INFO - Successfully wrote updated data to C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-10\test_guarda_rutina_exitosament0\users\test_user.json
2025-10-26 22:47:26 - agents.nodes.save_routine - INFO - Post-write verification passed.
2025-10-26 22:47:26 - agents.nodes.save_routine - INFO - --- Exiting Save Routine Node ---
2025-10-26 22:47:26 - agents.nodes.save_routine - INFO - --- Entering Save Routine Node ---
2025-10-26 22:47:26 - agents.nodes.save_routine - ERROR - 'rutina_final' missing or None in state.
2025-10-26 22:47:26 - agents.nodes.save_routine - INFO - --- Entering Save Routine Node ---
2025-10-26 22:47:26 - agents.nodes.save_routine - INFO - Attempting to save routine for user test_user to C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-10\test_maneja_error_io0\users\test_user.json
2025-10-26 22:47:26 - agents.nodes.save_routine - ERROR - File system error saving routine for test_user: Error de permisos simulado
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\save_routine.py", line 62, in save_routine
    with open(user_file_path, "r", encoding="utf-8") as f:
         ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python313\Lib\unittest\mock.py", line 1169, in __call__
    return self._mock_call(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python313\Lib\unittest\mock.py", line 1173, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python313\Lib\unittest\mock.py", line 1228, in _execute_mock_call
    raise effect
OSError: Error de permisos simulado
2025-10-26 22:47:26 - agents.nodes.save_routine - INFO - --- Exiting Save Routine Node ---
2025-10-26 22:47:26 - agents.nodes.handle_error - INFO - --- Entering Handle Error Node ---
2025-10-26 22:47:26 - agents.nodes.handle_error - ERROR - Error captured in step 'paso_anterior_fallo': Usuario 'xyz' no encontrado
2025-10-26 22:47:26 - agents.nodes.handle_error - INFO - Generated user-friendly error message: ❌ Lo siento, hubo un problema: Ocurrió un error inesperado procesando tu solicitud.
(Referencia: paso 'paso_anterior_fallo')
2025-10-26 22:47:26 - agents.nodes.handle_error - INFO - --- Exiting Handle Error Node ---
2025-10-26 22:47:26 - agents.nodes.handle_error - INFO - --- Entering Handle Error Node ---
2025-10-26 22:47:26 - agents.nodes.handle_error - ERROR - Error captured in step 'paso_anterior_fallo': Archivo corrupto para usuario 'abc': Unterminated string
2025-10-26 22:47:26 - agents.nodes.handle_error - INFO - Generated user-friendly error message: ❌ Lo siento, hubo un problema: Hubo un problema al leer los datos de tu perfil. Podría estar corrupto.
(Referencia: paso 'paso_anterior_fallo')
2025-10-26 22:47:26 - agents.nodes.handle_error - INFO - --- Exiting Handle Error Node ---
2025-10-26 22:47:26 - agents.nodes.handle_error - INFO - --- Entering Handle Error Node ---
2025-10-26 22:47:26 - agents.nodes.handle_error - ERROR - Error captured in step 'paso_anterior_fallo': Alucinación detectada: principios extraídos sin citas
2025-10-26 22:47:26 - agents.nodes.handle_error - INFO - Generated user-friendly error message: ❌ Lo siento, hubo un problema: No pude verificar la información extraída del libro (faltan citas). No puedo proceder de forma segura.
(Referencia: paso 'paso_anterior_fallo')
2025-10-26 22:47:26 - agents.nodes.handle_error - INFO - --- Exiting Handle Error Node ---
2025-10-26 22:47:26 - agents.nodes.handle_error - INFO - --- Entering Handle Error Node ---
2025-10-26 22:47:26 - agents.nodes.handle_error - ERROR - Error captured in step 'paso_anterior_fallo': Validación fallida: RIR inconsistente
2025-10-26 22:47:26 - agents.nodes.handle_error - INFO - Generated user-friendly error message: ❌ Lo siento, hubo un problema: La rutina generada no parece cumplir con los principios o tus preferencias.
(Referencia: paso 'paso_anterior_fallo')
2025-10-26 22:47:26 - agents.nodes.handle_error - INFO - --- Exiting Handle Error Node ---
2025-10-26 22:47:26 - agents.nodes.handle_error - INFO - --- Entering Handle Error Node ---
2025-10-26 22:47:26 - agents.nodes.handle_error - ERROR - Error captured in step 'paso_anterior_fallo': Error de archivo guardando rutina: [Errno 13] Permission denied
2025-10-26 22:47:26 - agents.nodes.handle_error - INFO - Generated user-friendly error message: ❌ Lo siento, hubo un problema: Hubo un problema al intentar guardar la rutina en tu perfil.
(Referencia: paso 'paso_anterior_fallo')
2025-10-26 22:47:26 - agents.nodes.handle_error - INFO - --- Exiting Handle Error Node ---
2025-10-26 22:47:26 - agents.nodes.handle_error - INFO - --- Entering Handle Error Node ---
2025-10-26 22:47:26 - agents.nodes.handle_error - ERROR - Error captured in step 'paso_anterior_fallo': Error desconocido criptográfico
2025-10-26 22:47:26 - agents.nodes.handle_error - INFO - Generated user-friendly error message: ❌ Lo siento, hubo un problema: Ocurrió un error inesperado procesando tu solicitud.
(Referencia: paso 'paso_anterior_fallo')
2025-10-26 22:47:26 - agents.nodes.handle_error - INFO - --- Exiting Handle Error Node ---
2025-10-26 22:47:26 - agents.nodes.load_context - INFO - --- Entering Load Context Node ---
2025-10-26 22:47:26 - agents.nodes.load_context - INFO - Attempting to load user profile from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\data\users\test_user.json
2025-10-26 22:47:26 - agents.nodes.load_context - ERROR - User file not found for user_id: test_user at C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\data\users\test_user.json
2025-10-26 22:47:26 - agents.nodes.handle_error - INFO - --- Entering Handle Error Node ---
2025-10-26 22:47:26 - agents.nodes.handle_error - ERROR - Error captured in step '': Error simulado para prueba de handle_error
2025-10-26 22:47:26 - agents.nodes.handle_error - INFO - Generated user-friendly error message: ❌ Lo siento, hubo un problema: Ocurrió un error inesperado procesando tu solicitud.
(Referencia: paso '')
2025-10-26 22:47:26 - agents.nodes.handle_error - INFO - --- Exiting Handle Error Node ---
2025-10-26 22:50:55 - agents.nodes.load_context - INFO - --- Entering Load Context Node ---
2025-10-26 22:50:55 - agents.nodes.load_context - INFO - Attempting to load user profile from: C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-11\test_carga_perfil_usuario_exit0\users\test_user.json
2025-10-26 22:50:55 - agents.nodes.load_context - INFO - Successfully loaded profile for user: test_user
2025-10-26 22:50:55 - agents.nodes.load_context - INFO - --- Exiting Load Context Node ---
2025-10-26 22:50:55 - agents.nodes.load_context - INFO - --- Entering Load Context Node ---
2025-10-26 22:50:55 - agents.nodes.load_context - INFO - Attempting to load user profile from: C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-11\test_maneja_usuario_no_encontr0\users\usuario_inexistente.json
2025-10-26 22:50:55 - agents.nodes.load_context - ERROR - User file not found for user_id: usuario_inexistente at C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-11\test_maneja_usuario_no_encontr0\users\usuario_inexistente.json
2025-10-26 22:50:55 - agents.nodes.load_context - INFO - --- Entering Load Context Node ---
2025-10-26 22:50:55 - agents.nodes.load_context - INFO - Attempting to load user profile from: C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-11\test_maneja_json_corrupto0\users\corrupt_user.json
2025-10-26 22:50:55 - agents.nodes.load_context - ERROR - Failed to decode JSON for user corrupt_user: Expecting property name enclosed in double quotes: line 1 column 48 (char 47)
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\load_context.py", line 45, in load_context
    user_profile = json.load(f)
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python313\Lib\json\__init__.py", line 293, in load
    return loads(fp.read(),
        cls=cls, object_hook=object_hook,
        parse_float=parse_float, parse_int=parse_int,
        parse_constant=parse_constant, object_pairs_hook=object_pairs_hook, **kw)
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python313\Lib\json\__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python313\Lib\json\decoder.py", line 345, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python313\Lib\json\decoder.py", line 361, in raw_decode
    obj, end = self.scan_once(s, idx)
               ~~~~~~~~~~~~~~^^^^^^^^
json.decoder.JSONDecodeError: Expecting property name enclosed in double quotes: line 1 column 48 (char 47)
2025-10-26 22:50:55 - agents.nodes.load_context - INFO - --- Exiting Load Context Node ---
2025-10-26 22:50:55 - agents.nodes.load_context - INFO - --- Entering Load Context Node ---
2025-10-26 22:50:55 - agents.nodes.load_context - INFO - Attempting to load user profile from: C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-11\test_maneja_perfil_incompleto0\users\incomplete_user.json
2025-10-26 22:50:55 - agents.nodes.load_context - ERROR - User profile for incomplete_user is incomplete. Missing fields: ['level', 'objetivo']
2025-10-26 22:50:55 - agents.nodes.extract_principles - INFO - --- Entering Extract Principles Node ---
2025-10-26 22:50:55 - agents.nodes.extract_principles - INFO - Initializing PrincipleExtractor...
2025-10-26 22:50:57 - rag.principle_extractor - INFO - PrincipleExtractor initialized.
2025-10-26 22:50:57 - agents.nodes.extract_principles - INFO - Extraction chain obtained. Invoking...
2025-10-26 22:50:57 - agents.nodes.extract_principles - INFO - Successfully extracted principles for user: test_user
2025-10-26 22:50:57 - agents.nodes.extract_principles - INFO - --- Exiting Extract Principles Node ---
2025-10-26 22:50:57 - agents.nodes.extract_principles - INFO - --- Entering Extract Principles Node ---
2025-10-26 22:50:57 - agents.nodes.extract_principles - INFO - Initializing PrincipleExtractor...
2025-10-26 22:50:58 - rag.principle_extractor - INFO - PrincipleExtractor initialized.
2025-10-26 22:50:58 - agents.nodes.extract_principles - INFO - Extraction chain obtained. Invoking...
2025-10-26 22:50:58 - agents.nodes.extract_principles - ERROR - CRITICAL: Extracted principles lack source citations!
2025-10-26 22:50:58 - agents.nodes.extract_principles - INFO - --- Entering Extract Principles Node ---
2025-10-26 22:50:58 - agents.nodes.extract_principles - INFO - Initializing PrincipleExtractor...
2025-10-26 22:50:59 - rag.principle_extractor - INFO - PrincipleExtractor initialized.
2025-10-26 22:50:59 - agents.nodes.extract_principles - INFO - Extraction chain obtained. Invoking...
2025-10-26 22:50:59 - agents.nodes.extract_principles - INFO - Successfully extracted principles for user: test_user
2025-10-26 22:50:59 - agents.nodes.extract_principles - INFO - --- Exiting Extract Principles Node ---
2025-10-26 22:50:59 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 22:50:59 - agents.nodes.generate_routine - INFO - Loading routine assembler prompt from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\routine_assembler.txt
2025-10-26 22:50:59 - agents.nodes.generate_routine - INFO - Routine generation chain built.
2025-10-26 22:50:59 - agents.nodes.generate_routine - INFO - Attempt 1/3 to generate routine...
2025-10-26 22:50:59 - agents.nodes.generate_routine - INFO - LLM invocation successful.
2025-10-26 22:50:59 - agents.nodes.generate_routine - INFO - Successfully generated and validated routine in 0.01 seconds.
2025-10-26 22:50:59 - agents.nodes.generate_routine - INFO - --- Exiting Generate Routine Node ---
2025-10-26 22:50:59 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 22:50:59 - agents.nodes.generate_routine - ERROR - 'principios_libro' missing in state.
2025-10-26 22:50:59 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 22:50:59 - agents.nodes.generate_routine - INFO - Loading routine assembler prompt from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\routine_assembler.txt
2025-10-26 22:50:59 - agents.nodes.generate_routine - INFO - Routine generation chain built.
2025-10-26 22:50:59 - agents.nodes.generate_routine - INFO - Attempt 1/3 to generate routine...
2025-10-26 22:50:59 - agents.nodes.generate_routine - ERROR - Attempt 1 failed with unexpected error: LLM Error simulado
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
Exception: LLM Error simulado
2025-10-26 22:51:00 - agents.nodes.generate_routine - INFO - Attempt 2/3 to generate routine...
2025-10-26 22:51:00 - agents.nodes.generate_routine - ERROR - Attempt 2 failed with unexpected error: LLM Error simulado
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
Exception: LLM Error simulado
2025-10-26 22:51:01 - agents.nodes.generate_routine - INFO - Attempt 3/3 to generate routine...
2025-10-26 22:51:01 - agents.nodes.generate_routine - ERROR - Attempt 3 failed with unexpected error: LLM Error simulado
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
Exception: LLM Error simulado
2025-10-26 22:51:02 - agents.nodes.generate_routine - ERROR - Failed to generate valid routine after 3 attempts.
2025-10-26 22:51:02 - agents.nodes.save_routine - INFO - --- Entering Save Routine Node ---
2025-10-26 22:51:02 - agents.nodes.save_routine - INFO - Attempting to save routine for user test_user to C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-11\test_guarda_rutina_exitosament0\users\test_user.json
2025-10-26 22:51:02 - agents.nodes.save_routine - INFO - Created backup at: C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-11\test_guarda_rutina_exitosament0\users\test_user.20251026225102.backup
2025-10-26 22:51:02 - agents.nodes.save_routine - INFO - Successfully wrote updated data to C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-11\test_guarda_rutina_exitosament0\users\test_user.json
2025-10-26 22:51:02 - agents.nodes.save_routine - INFO - Post-write verification passed.
2025-10-26 22:51:02 - agents.nodes.save_routine - INFO - --- Exiting Save Routine Node ---
2025-10-26 22:51:02 - agents.nodes.save_routine - INFO - --- Entering Save Routine Node ---
2025-10-26 22:51:02 - agents.nodes.save_routine - ERROR - 'rutina_final' missing or None in state.
2025-10-26 22:51:02 - agents.nodes.save_routine - INFO - --- Entering Save Routine Node ---
2025-10-26 22:51:02 - agents.nodes.save_routine - INFO - Attempting to save routine for user test_user to C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-11\test_maneja_error_io0\users\test_user.json
2025-10-26 22:51:02 - agents.nodes.save_routine - ERROR - File system error saving routine for test_user: Error de permisos simulado
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\save_routine.py", line 62, in save_routine
    with open(user_file_path, "r", encoding="utf-8") as f:
         ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python313\Lib\unittest\mock.py", line 1169, in __call__
    return self._mock_call(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python313\Lib\unittest\mock.py", line 1173, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python313\Lib\unittest\mock.py", line 1228, in _execute_mock_call
    raise effect
OSError: Error de permisos simulado
2025-10-26 22:51:02 - agents.nodes.save_routine - INFO - --- Exiting Save Routine Node ---
2025-10-26 22:51:02 - agents.nodes.handle_error - INFO - --- Entering Handle Error Node ---
2025-10-26 22:51:02 - agents.nodes.handle_error - ERROR - Error captured in step 'paso_anterior_fallo': Usuario 'xyz' no encontrado
2025-10-26 22:51:02 - agents.nodes.handle_error - INFO - Generated user-friendly error message: ❌ Lo siento, hubo un problema: Tu perfil de usuario no se encontró en el sistema.
(Referencia: paso 'paso_anterior_fallo')
2025-10-26 22:51:02 - agents.nodes.handle_error - INFO - --- Exiting Handle Error Node ---
2025-10-26 22:51:02 - agents.nodes.handle_error - INFO - --- Entering Handle Error Node ---
2025-10-26 22:51:02 - agents.nodes.handle_error - ERROR - Error captured in step 'paso_anterior_fallo': Archivo corrupto para usuario 'abc': Unterminated string
2025-10-26 22:51:02 - agents.nodes.handle_error - INFO - Generated user-friendly error message: ❌ Lo siento, hubo un problema: Hubo un problema al leer los datos de tu perfil. Podría estar corrupto.
(Referencia: paso 'paso_anterior_fallo')
2025-10-26 22:51:02 - agents.nodes.handle_error - INFO - --- Exiting Handle Error Node ---
2025-10-26 22:51:02 - agents.nodes.handle_error - INFO - --- Entering Handle Error Node ---
2025-10-26 22:51:02 - agents.nodes.handle_error - ERROR - Error captured in step 'paso_anterior_fallo': Alucinación detectada: principios extraídos sin citas
2025-10-26 22:51:02 - agents.nodes.handle_error - INFO - Generated user-friendly error message: ❌ Lo siento, hubo un problema: No pude verificar la información extraída del libro (faltan citas). No puedo proceder de forma segura.
(Referencia: paso 'paso_anterior_fallo')
2025-10-26 22:51:02 - agents.nodes.handle_error - INFO - --- Exiting Handle Error Node ---
2025-10-26 22:51:02 - agents.nodes.handle_error - INFO - --- Entering Handle Error Node ---
2025-10-26 22:51:02 - agents.nodes.handle_error - ERROR - Error captured in step 'paso_anterior_fallo': Validación fallida: RIR inconsistente
2025-10-26 22:51:02 - agents.nodes.handle_error - INFO - Generated user-friendly error message: ❌ Lo siento, hubo un problema: La rutina generada no respeta el RIR recomendado por el libro.
(Referencia: paso 'paso_anterior_fallo')
2025-10-26 22:51:02 - agents.nodes.handle_error - INFO - --- Exiting Handle Error Node ---
2025-10-26 22:51:02 - agents.nodes.handle_error - INFO - --- Entering Handle Error Node ---
2025-10-26 22:51:02 - agents.nodes.handle_error - ERROR - Error captured in step 'paso_anterior_fallo': Error de archivo guardando rutina: [Errno 13] Permission denied
2025-10-26 22:51:02 - agents.nodes.handle_error - INFO - Generated user-friendly error message: ❌ Lo siento, hubo un problema: Error del sistema al intentar guardar (problema de permisos).
(Referencia: paso 'paso_anterior_fallo')
2025-10-26 22:51:02 - agents.nodes.handle_error - INFO - --- Exiting Handle Error Node ---
2025-10-26 22:51:02 - agents.nodes.handle_error - INFO - --- Entering Handle Error Node ---
2025-10-26 22:51:02 - agents.nodes.handle_error - ERROR - Error captured in step 'paso_anterior_fallo': Error desconocido criptográfico
2025-10-26 22:51:02 - agents.nodes.handle_error - INFO - Generated user-friendly error message: ❌ Lo siento, hubo un problema: Ocurrió un error inesperado procesando tu solicitud.
(Referencia: paso 'paso_anterior_fallo')
2025-10-26 22:51:02 - agents.nodes.handle_error - INFO - --- Exiting Handle Error Node ---
2025-10-26 22:51:02 - agents.nodes.load_context - INFO - --- Entering Load Context Node ---
2025-10-26 22:51:02 - agents.nodes.load_context - INFO - Attempting to load user profile from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\data\users\test_user.json
2025-10-26 22:51:02 - agents.nodes.load_context - ERROR - User file not found for user_id: test_user at C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\data\users\test_user.json
2025-10-26 22:51:02 - agents.nodes.handle_error - INFO - --- Entering Handle Error Node ---
2025-10-26 22:51:02 - agents.nodes.handle_error - ERROR - Error captured in step '': Error simulado para prueba de handle_error
2025-10-26 22:51:02 - agents.nodes.handle_error - INFO - Generated user-friendly error message: ❌ Lo siento, hubo un problema: Ocurrió un error inesperado procesando tu solicitud.
(Referencia: paso '')
2025-10-26 22:51:02 - agents.nodes.handle_error - INFO - --- Exiting Handle Error Node ---
2025-10-26 22:52:05 - agents.nodes.load_context - INFO - --- Entering Load Context Node ---
2025-10-26 22:52:05 - agents.nodes.load_context - INFO - Attempting to load user profile from: C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-12\test_carga_perfil_usuario_exit0\users\test_user.json
2025-10-26 22:52:05 - agents.nodes.load_context - INFO - Successfully loaded profile for user: test_user
2025-10-26 22:52:05 - agents.nodes.load_context - INFO - --- Exiting Load Context Node ---
2025-10-26 22:52:05 - agents.nodes.load_context - INFO - --- Entering Load Context Node ---
2025-10-26 22:52:05 - agents.nodes.load_context - INFO - Attempting to load user profile from: C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-12\test_maneja_usuario_no_encontr0\users\usuario_inexistente.json
2025-10-26 22:52:05 - agents.nodes.load_context - ERROR - User file not found for user_id: usuario_inexistente at C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-12\test_maneja_usuario_no_encontr0\users\usuario_inexistente.json
2025-10-26 22:52:05 - agents.nodes.load_context - INFO - --- Entering Load Context Node ---
2025-10-26 22:52:05 - agents.nodes.load_context - INFO - Attempting to load user profile from: C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-12\test_maneja_json_corrupto0\users\corrupt_user.json
2025-10-26 22:52:05 - agents.nodes.load_context - ERROR - Failed to decode JSON for user corrupt_user: Expecting property name enclosed in double quotes: line 1 column 48 (char 47)
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\load_context.py", line 45, in load_context
    user_profile = json.load(f)
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python313\Lib\json\__init__.py", line 293, in load
    return loads(fp.read(),
        cls=cls, object_hook=object_hook,
        parse_float=parse_float, parse_int=parse_int,
        parse_constant=parse_constant, object_pairs_hook=object_pairs_hook, **kw)
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python313\Lib\json\__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python313\Lib\json\decoder.py", line 345, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python313\Lib\json\decoder.py", line 361, in raw_decode
    obj, end = self.scan_once(s, idx)
               ~~~~~~~~~~~~~~^^^^^^^^
json.decoder.JSONDecodeError: Expecting property name enclosed in double quotes: line 1 column 48 (char 47)
2025-10-26 22:52:05 - agents.nodes.load_context - INFO - --- Exiting Load Context Node ---
2025-10-26 22:52:05 - agents.nodes.load_context - INFO - --- Entering Load Context Node ---
2025-10-26 22:52:05 - agents.nodes.load_context - INFO - Attempting to load user profile from: C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-12\test_maneja_perfil_incompleto0\users\incomplete_user.json
2025-10-26 22:52:05 - agents.nodes.load_context - ERROR - User profile for incomplete_user is incomplete. Missing fields: ['level', 'objetivo']
2025-10-26 22:52:05 - agents.nodes.extract_principles - INFO - --- Entering Extract Principles Node ---
2025-10-26 22:52:05 - agents.nodes.extract_principles - INFO - Initializing PrincipleExtractor...
2025-10-26 22:52:07 - rag.principle_extractor - INFO - PrincipleExtractor initialized.
2025-10-26 22:52:07 - agents.nodes.extract_principles - INFO - Extraction chain obtained. Invoking...
2025-10-26 22:52:07 - agents.nodes.extract_principles - INFO - Successfully extracted principles for user: test_user
2025-10-26 22:52:07 - agents.nodes.extract_principles - INFO - --- Exiting Extract Principles Node ---
2025-10-26 22:52:07 - agents.nodes.extract_principles - INFO - --- Entering Extract Principles Node ---
2025-10-26 22:52:07 - agents.nodes.extract_principles - INFO - Initializing PrincipleExtractor...
2025-10-26 22:52:08 - rag.principle_extractor - INFO - PrincipleExtractor initialized.
2025-10-26 22:52:08 - agents.nodes.extract_principles - INFO - Extraction chain obtained. Invoking...
2025-10-26 22:52:08 - agents.nodes.extract_principles - ERROR - CRITICAL: Extracted principles lack source citations!
2025-10-26 22:52:08 - agents.nodes.extract_principles - INFO - --- Entering Extract Principles Node ---
2025-10-26 22:52:08 - agents.nodes.extract_principles - INFO - Initializing PrincipleExtractor...
2025-10-26 22:52:09 - rag.principle_extractor - INFO - PrincipleExtractor initialized.
2025-10-26 22:52:09 - agents.nodes.extract_principles - INFO - Extraction chain obtained. Invoking...
2025-10-26 22:52:09 - agents.nodes.extract_principles - INFO - Successfully extracted principles for user: test_user
2025-10-26 22:52:09 - agents.nodes.extract_principles - INFO - --- Exiting Extract Principles Node ---
2025-10-26 22:52:09 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 22:52:09 - agents.nodes.generate_routine - INFO - Loading routine assembler prompt from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\routine_assembler.txt
2025-10-26 22:52:09 - agents.nodes.generate_routine - INFO - Routine generation chain built.
2025-10-26 22:52:09 - agents.nodes.generate_routine - INFO - Attempt 1/3 to generate routine...
2025-10-26 22:52:09 - agents.nodes.generate_routine - INFO - LLM invocation successful.
2025-10-26 22:52:09 - agents.nodes.generate_routine - INFO - Successfully generated and validated routine in 0.01 seconds.
2025-10-26 22:52:09 - agents.nodes.generate_routine - INFO - --- Exiting Generate Routine Node ---
2025-10-26 22:52:09 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 22:52:09 - agents.nodes.generate_routine - ERROR - 'principios_libro' missing in state.
2025-10-26 22:52:09 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 22:52:09 - agents.nodes.generate_routine - INFO - Loading routine assembler prompt from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\routine_assembler.txt
2025-10-26 22:52:09 - agents.nodes.generate_routine - INFO - Routine generation chain built.
2025-10-26 22:52:09 - agents.nodes.generate_routine - INFO - Attempt 1/3 to generate routine...
2025-10-26 22:52:09 - agents.nodes.generate_routine - ERROR - Attempt 1 failed with unexpected error: LLM Error simulado
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
Exception: LLM Error simulado
2025-10-26 22:52:10 - agents.nodes.generate_routine - INFO - Attempt 2/3 to generate routine...
2025-10-26 22:52:10 - agents.nodes.generate_routine - ERROR - Attempt 2 failed with unexpected error: LLM Error simulado
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
Exception: LLM Error simulado
2025-10-26 22:52:11 - agents.nodes.generate_routine - INFO - Attempt 3/3 to generate routine...
2025-10-26 22:52:11 - agents.nodes.generate_routine - ERROR - Attempt 3 failed with unexpected error: LLM Error simulado
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
Exception: LLM Error simulado
2025-10-26 22:52:12 - agents.nodes.generate_routine - ERROR - Failed to generate valid routine after 3 attempts.
2025-10-26 22:52:12 - agents.nodes.save_routine - INFO - --- Entering Save Routine Node ---
2025-10-26 22:52:12 - agents.nodes.save_routine - INFO - Attempting to save routine for user test_user to C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-12\test_guarda_rutina_exitosament0\users\test_user.json
2025-10-26 22:52:12 - agents.nodes.save_routine - INFO - Created backup at: C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-12\test_guarda_rutina_exitosament0\users\test_user.20251026225212.backup
2025-10-26 22:52:12 - agents.nodes.save_routine - INFO - Successfully wrote updated data to C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-12\test_guarda_rutina_exitosament0\users\test_user.json
2025-10-26 22:52:12 - agents.nodes.save_routine - INFO - Post-write verification passed.
2025-10-26 22:52:12 - agents.nodes.save_routine - INFO - --- Exiting Save Routine Node ---
2025-10-26 22:52:12 - agents.nodes.save_routine - INFO - --- Entering Save Routine Node ---
2025-10-26 22:52:12 - agents.nodes.save_routine - ERROR - 'rutina_final' missing or None in state.
2025-10-26 22:52:12 - agents.nodes.save_routine - INFO - --- Entering Save Routine Node ---
2025-10-26 22:52:12 - agents.nodes.save_routine - INFO - Attempting to save routine for user test_user to C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-12\test_maneja_error_io0\users\test_user.json
2025-10-26 22:52:12 - agents.nodes.save_routine - ERROR - File system error saving routine for test_user: Error de permisos simulado
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\save_routine.py", line 62, in save_routine
    with open(user_file_path, "r", encoding="utf-8") as f:
         ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python313\Lib\unittest\mock.py", line 1169, in __call__
    return self._mock_call(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python313\Lib\unittest\mock.py", line 1173, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python313\Lib\unittest\mock.py", line 1228, in _execute_mock_call
    raise effect
OSError: Error de permisos simulado
2025-10-26 22:52:12 - agents.nodes.save_routine - INFO - --- Exiting Save Routine Node ---
2025-10-26 22:52:12 - agents.nodes.handle_error - INFO - --- Entering Handle Error Node ---
2025-10-26 22:52:12 - agents.nodes.handle_error - ERROR - Error captured in step 'paso_anterior_fallo': Usuario 'xyz' no encontrado
2025-10-26 22:52:12 - agents.nodes.handle_error - INFO - Generated user-friendly error message: ❌ Lo siento, hubo un problema: Tu perfil de usuario no se encontró en el sistema.
(Referencia: paso 'paso_anterior_fallo')
2025-10-26 22:52:12 - agents.nodes.handle_error - INFO - --- Exiting Handle Error Node ---
2025-10-26 22:52:12 - agents.nodes.handle_error - INFO - --- Entering Handle Error Node ---
2025-10-26 22:52:12 - agents.nodes.handle_error - ERROR - Error captured in step 'paso_anterior_fallo': Archivo corrupto para usuario 'abc': Unterminated string
2025-10-26 22:52:12 - agents.nodes.handle_error - INFO - Generated user-friendly error message: ❌ Lo siento, hubo un problema: Hubo un problema al leer los datos de tu perfil. Podría estar corrupto.
(Referencia: paso 'paso_anterior_fallo')
2025-10-26 22:52:12 - agents.nodes.handle_error - INFO - --- Exiting Handle Error Node ---
2025-10-26 22:52:12 - agents.nodes.handle_error - INFO - --- Entering Handle Error Node ---
2025-10-26 22:52:12 - agents.nodes.handle_error - ERROR - Error captured in step 'paso_anterior_fallo': Alucinación detectada: principios extraídos sin citas
2025-10-26 22:52:12 - agents.nodes.handle_error - INFO - Generated user-friendly error message: ❌ Lo siento, hubo un problema: No pude verificar la información extraída del libro (faltan citas). No puedo proceder de forma segura.
(Referencia: paso 'paso_anterior_fallo')
2025-10-26 22:52:12 - agents.nodes.handle_error - INFO - --- Exiting Handle Error Node ---
2025-10-26 22:52:12 - agents.nodes.handle_error - INFO - --- Entering Handle Error Node ---
2025-10-26 22:52:12 - agents.nodes.handle_error - ERROR - Error captured in step 'paso_anterior_fallo': Validación fallida: RIR inconsistente
2025-10-26 22:52:12 - agents.nodes.handle_error - INFO - Generated user-friendly error message: ❌ Lo siento, hubo un problema: La rutina generada no respeta el RIR recomendado por el libro.
(Referencia: paso 'paso_anterior_fallo')
2025-10-26 22:52:12 - agents.nodes.handle_error - INFO - --- Exiting Handle Error Node ---
2025-10-26 22:52:12 - agents.nodes.handle_error - INFO - --- Entering Handle Error Node ---
2025-10-26 22:52:12 - agents.nodes.handle_error - ERROR - Error captured in step 'paso_anterior_fallo': Error de archivo guardando rutina: [Errno 13] Permission denied
2025-10-26 22:52:12 - agents.nodes.handle_error - INFO - Generated user-friendly error message: ❌ Lo siento, hubo un problema: Error del sistema al intentar guardar (problema de permisos).
(Referencia: paso 'paso_anterior_fallo')
2025-10-26 22:52:12 - agents.nodes.handle_error - INFO - --- Exiting Handle Error Node ---
2025-10-26 22:52:12 - agents.nodes.handle_error - INFO - --- Entering Handle Error Node ---
2025-10-26 22:52:12 - agents.nodes.handle_error - ERROR - Error captured in step 'paso_anterior_fallo': Error desconocido criptográfico
2025-10-26 22:52:12 - agents.nodes.handle_error - INFO - Generated user-friendly error message: ❌ Lo siento, hubo un problema: Ocurrió un error inesperado procesando tu solicitud.
(Referencia: paso 'paso_anterior_fallo')
2025-10-26 22:52:12 - agents.nodes.handle_error - INFO - --- Exiting Handle Error Node ---
2025-10-26 22:52:12 - agents.nodes.load_context - INFO - --- Entering Load Context Node ---
2025-10-26 22:52:12 - agents.nodes.load_context - INFO - Attempting to load user profile from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\data\users\test_user.json
2025-10-26 22:52:12 - agents.nodes.load_context - ERROR - User file not found for user_id: test_user at C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\data\users\test_user.json
2025-10-26 22:52:12 - agents.nodes.handle_error - INFO - --- Entering Handle Error Node ---
2025-10-26 22:52:12 - agents.nodes.handle_error - ERROR - Error captured in step '': Error simulado para prueba de handle_error
2025-10-26 22:52:12 - agents.nodes.handle_error - INFO - Generated user-friendly error message: ❌ Lo siento, hubo un problema: Ocurrió un error inesperado procesando tu solicitud.
(Referencia: paso '')
2025-10-26 22:52:12 - agents.nodes.handle_error - INFO - --- Exiting Handle Error Node ---
2025-10-26 22:52:12 - rag.vectorstore_manager - INFO - Loading existing vector store from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\data\chroma_db
2025-10-26 22:52:14 - rag.vectorstore_manager - INFO - ✅ Vector store loaded successfully.
2025-10-26 22:52:17 - rag.principle_extractor - INFO - PrincipleExtractor initialized.
2025-10-26 22:52:17 - rag.principle_extractor - INFO - Building the principle extraction RAG chain...
2025-10-26 22:52:17 - rag.principle_extractor - INFO - Loading prompt template from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\rag_principle_extractor.txt
2025-10-26 22:52:17 - rag.principle_extractor - INFO - Prompt template loaded successfully.
2025-10-26 22:52:17 - rag.vectorstore_manager - INFO - Loading existing vector store from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\data\chroma_db
2025-10-26 22:52:17 - rag.vectorstore_manager - INFO - ✅ Vector store loaded successfully.
2025-10-26 22:52:17 - rag.principle_extractor - INFO - Retriever obtained from vector store.
2025-10-26 22:52:17 - rag.principle_extractor - INFO - PromptTemplate instance created.
2025-10-26 22:52:17 - rag.principle_extractor - INFO - ✅ Principle extraction RAG chain built successfully.
2025-10-26 22:52:18 - rag.principle_extractor - INFO - PrincipleExtractor initialized.
2025-10-26 22:52:18 - rag.principle_extractor - INFO - Building the principle extraction RAG chain...
2025-10-26 22:52:18 - rag.principle_extractor - INFO - Loading prompt template from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\rag_principle_extractor.txt
2025-10-26 22:52:18 - rag.principle_extractor - INFO - Prompt template loaded successfully.
2025-10-26 22:52:18 - rag.vectorstore_manager - INFO - Loading existing vector store from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\data\chroma_db
2025-10-26 22:52:18 - rag.vectorstore_manager - INFO - ✅ Vector store loaded successfully.
2025-10-26 22:52:18 - rag.principle_extractor - INFO - Retriever obtained from vector store.
2025-10-26 22:52:18 - rag.principle_extractor - INFO - PromptTemplate instance created.
2025-10-26 22:52:18 - rag.principle_extractor - INFO - ✅ Principle extraction RAG chain built successfully.
2025-10-26 22:52:19 - rag.principle_extractor - INFO - PrincipleExtractor initialized.
2025-10-26 22:52:19 - rag.principle_extractor - INFO - Building the principle extraction RAG chain...
2025-10-26 22:52:19 - rag.principle_extractor - INFO - Loading prompt template from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\rag_principle_extractor.txt
2025-10-26 22:52:19 - rag.principle_extractor - INFO - Prompt template loaded successfully.
2025-10-26 22:52:19 - rag.vectorstore_manager - INFO - Loading existing vector store from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\data\chroma_db
2025-10-26 22:52:19 - rag.vectorstore_manager - INFO - ✅ Vector store loaded successfully.
2025-10-26 22:52:19 - rag.principle_extractor - INFO - Retriever obtained from vector store.
2025-10-26 22:52:19 - rag.principle_extractor - INFO - PromptTemplate instance created.
2025-10-26 22:52:19 - rag.principle_extractor - INFO - ✅ Principle extraction RAG chain built successfully.
2025-10-26 22:52:20 - rag.principle_extractor - INFO - PrincipleExtractor initialized.
2025-10-26 22:52:20 - rag.principle_extractor - INFO - Building the principle extraction RAG chain...
2025-10-26 22:52:20 - rag.principle_extractor - INFO - Loading prompt template from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\rag_principle_extractor.txt
2025-10-26 22:52:20 - rag.principle_extractor - INFO - Prompt template loaded successfully.
2025-10-26 22:52:20 - rag.vectorstore_manager - INFO - Loading existing vector store from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\data\chroma_db
2025-10-26 22:52:20 - rag.vectorstore_manager - INFO - ✅ Vector store loaded successfully.
2025-10-26 22:52:20 - rag.principle_extractor - INFO - Retriever obtained from vector store.
2025-10-26 22:52:20 - rag.principle_extractor - INFO - PromptTemplate instance created.
2025-10-26 22:52:20 - rag.principle_extractor - INFO - ✅ Principle extraction RAG chain built successfully.
2025-10-26 22:52:21 - rag.principle_extractor - INFO - PrincipleExtractor initialized.
2025-10-26 22:52:21 - rag.principle_extractor - INFO - Building the principle extraction RAG chain...
2025-10-26 22:52:21 - rag.principle_extractor - INFO - Loading prompt template from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\rag_principle_extractor.txt
2025-10-26 22:52:21 - rag.principle_extractor - INFO - Prompt template loaded successfully.
2025-10-26 22:52:21 - rag.vectorstore_manager - INFO - Loading existing vector store from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\data\chroma_db
2025-10-26 22:52:21 - rag.vectorstore_manager - INFO - ✅ Vector store loaded successfully.
2025-10-26 22:52:21 - rag.principle_extractor - INFO - Retriever obtained from vector store.
2025-10-26 22:52:21 - rag.principle_extractor - INFO - PromptTemplate instance created.
2025-10-26 22:52:21 - rag.principle_extractor - INFO - ✅ Principle extraction RAG chain built successfully.
2025-10-26 22:59:13 - agents.nodes.load_context - INFO - --- Entering Load Context Node ---
2025-10-26 22:59:13 - agents.nodes.load_context - INFO - Attempting to load user profile from: C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-13\test_carga_perfil_usuario_exit0\users\test_user.json
2025-10-26 22:59:13 - agents.nodes.load_context - INFO - Successfully loaded profile for user: test_user
2025-10-26 22:59:13 - agents.nodes.load_context - INFO - --- Exiting Load Context Node ---
2025-10-26 22:59:13 - agents.nodes.load_context - INFO - --- Entering Load Context Node ---
2025-10-26 22:59:13 - agents.nodes.load_context - INFO - Attempting to load user profile from: C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-13\test_maneja_usuario_no_encontr0\users\usuario_inexistente.json
2025-10-26 22:59:13 - agents.nodes.load_context - ERROR - User file not found for user_id: usuario_inexistente at C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-13\test_maneja_usuario_no_encontr0\users\usuario_inexistente.json
2025-10-26 22:59:13 - agents.nodes.load_context - INFO - --- Entering Load Context Node ---
2025-10-26 22:59:13 - agents.nodes.load_context - INFO - Attempting to load user profile from: C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-13\test_maneja_json_corrupto0\users\corrupt_user.json
2025-10-26 22:59:13 - agents.nodes.load_context - ERROR - Failed to decode JSON for user corrupt_user: Expecting property name enclosed in double quotes: line 1 column 48 (char 47)
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\load_context.py", line 45, in load_context
    user_profile = json.load(f)
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python313\Lib\json\__init__.py", line 293, in load
    return loads(fp.read(),
        cls=cls, object_hook=object_hook,
        parse_float=parse_float, parse_int=parse_int,
        parse_constant=parse_constant, object_pairs_hook=object_pairs_hook, **kw)
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python313\Lib\json\__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python313\Lib\json\decoder.py", line 345, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python313\Lib\json\decoder.py", line 361, in raw_decode
    obj, end = self.scan_once(s, idx)
               ~~~~~~~~~~~~~~^^^^^^^^
json.decoder.JSONDecodeError: Expecting property name enclosed in double quotes: line 1 column 48 (char 47)
2025-10-26 22:59:13 - agents.nodes.load_context - INFO - --- Exiting Load Context Node ---
2025-10-26 22:59:13 - agents.nodes.load_context - INFO - --- Entering Load Context Node ---
2025-10-26 22:59:13 - agents.nodes.load_context - INFO - Attempting to load user profile from: C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-13\test_maneja_perfil_incompleto0\users\incomplete_user.json
2025-10-26 22:59:13 - agents.nodes.load_context - ERROR - User profile for incomplete_user is incomplete. Missing fields: ['level', 'objetivo']
2025-10-26 22:59:13 - agents.nodes.extract_principles - INFO - --- Entering Extract Principles Node ---
2025-10-26 22:59:13 - agents.nodes.extract_principles - INFO - Initializing PrincipleExtractor...
2025-10-26 22:59:15 - rag.principle_extractor - INFO - PrincipleExtractor initialized.
2025-10-26 22:59:15 - agents.nodes.extract_principles - INFO - Extraction chain obtained. Invoking...
2025-10-26 22:59:15 - agents.nodes.extract_principles - INFO - Successfully extracted principles for user: test_user
2025-10-26 22:59:15 - agents.nodes.extract_principles - INFO - --- Exiting Extract Principles Node ---
2025-10-26 22:59:15 - agents.nodes.extract_principles - INFO - --- Entering Extract Principles Node ---
2025-10-26 22:59:15 - agents.nodes.extract_principles - INFO - Initializing PrincipleExtractor...
2025-10-26 22:59:16 - rag.principle_extractor - INFO - PrincipleExtractor initialized.
2025-10-26 22:59:16 - agents.nodes.extract_principles - INFO - Extraction chain obtained. Invoking...
2025-10-26 22:59:16 - agents.nodes.extract_principles - ERROR - CRITICAL: Extracted principles lack source citations!
2025-10-26 22:59:16 - agents.nodes.extract_principles - INFO - --- Entering Extract Principles Node ---
2025-10-26 22:59:16 - agents.nodes.extract_principles - INFO - Initializing PrincipleExtractor...
2025-10-26 22:59:17 - rag.principle_extractor - INFO - PrincipleExtractor initialized.
2025-10-26 22:59:17 - agents.nodes.extract_principles - INFO - Extraction chain obtained. Invoking...
2025-10-26 22:59:17 - agents.nodes.extract_principles - INFO - Successfully extracted principles for user: test_user
2025-10-26 22:59:17 - agents.nodes.extract_principles - INFO - --- Exiting Extract Principles Node ---
2025-10-26 22:59:17 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 22:59:17 - agents.nodes.generate_routine - INFO - Loading routine assembler prompt from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\routine_assembler.txt
2025-10-26 22:59:17 - agents.nodes.generate_routine - INFO - Routine generation chain built.
2025-10-26 22:59:17 - agents.nodes.generate_routine - INFO - Attempt 1/3 to generate routine...
2025-10-26 22:59:17 - agents.nodes.generate_routine - INFO - LLM invocation successful.
2025-10-26 22:59:17 - agents.nodes.generate_routine - INFO - Successfully generated and validated routine in 0.01 seconds.
2025-10-26 22:59:17 - agents.nodes.generate_routine - INFO - --- Exiting Generate Routine Node ---
2025-10-26 22:59:17 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 22:59:17 - agents.nodes.generate_routine - ERROR - 'principios_libro' missing in state.
2025-10-26 22:59:17 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 22:59:17 - agents.nodes.generate_routine - INFO - Loading routine assembler prompt from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\routine_assembler.txt
2025-10-26 22:59:17 - agents.nodes.generate_routine - INFO - Routine generation chain built.
2025-10-26 22:59:17 - agents.nodes.generate_routine - INFO - Attempt 1/3 to generate routine...
2025-10-26 22:59:17 - agents.nodes.generate_routine - ERROR - Attempt 1 failed with unexpected error: LLM Error simulado
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
Exception: LLM Error simulado
2025-10-26 22:59:18 - agents.nodes.generate_routine - INFO - Attempt 2/3 to generate routine...
2025-10-26 22:59:18 - agents.nodes.generate_routine - ERROR - Attempt 2 failed with unexpected error: LLM Error simulado
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
Exception: LLM Error simulado
2025-10-26 22:59:19 - agents.nodes.generate_routine - INFO - Attempt 3/3 to generate routine...
2025-10-26 22:59:19 - agents.nodes.generate_routine - ERROR - Attempt 3 failed with unexpected error: LLM Error simulado
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
Exception: LLM Error simulado
2025-10-26 22:59:20 - agents.nodes.generate_routine - ERROR - Failed to generate valid routine after 3 attempts.
2025-10-26 22:59:20 - agents.nodes.save_routine - INFO - --- Entering Save Routine Node ---
2025-10-26 22:59:20 - agents.nodes.save_routine - INFO - Attempting to save routine for user test_user to C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-13\test_guarda_rutina_exitosament0\users\test_user.json
2025-10-26 22:59:20 - agents.nodes.save_routine - INFO - Created backup at: C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-13\test_guarda_rutina_exitosament0\users\test_user.20251026225920.backup
2025-10-26 22:59:20 - agents.nodes.save_routine - INFO - Successfully wrote updated data to C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-13\test_guarda_rutina_exitosament0\users\test_user.json
2025-10-26 22:59:20 - agents.nodes.save_routine - INFO - Post-write verification passed.
2025-10-26 22:59:20 - agents.nodes.save_routine - INFO - --- Exiting Save Routine Node ---
2025-10-26 22:59:20 - agents.nodes.save_routine - INFO - --- Entering Save Routine Node ---
2025-10-26 22:59:20 - agents.nodes.save_routine - ERROR - 'rutina_final' missing or None in state.
2025-10-26 22:59:20 - agents.nodes.save_routine - INFO - --- Entering Save Routine Node ---
2025-10-26 22:59:20 - agents.nodes.save_routine - INFO - Attempting to save routine for user test_user to C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-13\test_maneja_error_io0\users\test_user.json
2025-10-26 22:59:20 - agents.nodes.save_routine - ERROR - File system error saving routine for test_user: Error de permisos simulado
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\save_routine.py", line 62, in save_routine
    with open(user_file_path, "r", encoding="utf-8") as f:
         ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python313\Lib\unittest\mock.py", line 1169, in __call__
    return self._mock_call(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python313\Lib\unittest\mock.py", line 1173, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python313\Lib\unittest\mock.py", line 1228, in _execute_mock_call
    raise effect
OSError: Error de permisos simulado
2025-10-26 22:59:20 - agents.nodes.save_routine - INFO - --- Exiting Save Routine Node ---
2025-10-26 22:59:20 - agents.nodes.handle_error - INFO - --- Entering Handle Error Node ---
2025-10-26 22:59:20 - agents.nodes.handle_error - ERROR - Error captured in step 'paso_anterior_fallo': Usuario 'xyz' no encontrado
2025-10-26 22:59:20 - agents.nodes.handle_error - INFO - Generated user-friendly error message: ❌ Lo siento, hubo un problema: Tu perfil de usuario no se encontró en el sistema.
(Referencia: paso 'paso_anterior_fallo')
2025-10-26 22:59:20 - agents.nodes.handle_error - INFO - --- Exiting Handle Error Node ---
2025-10-26 22:59:20 - agents.nodes.handle_error - INFO - --- Entering Handle Error Node ---
2025-10-26 22:59:20 - agents.nodes.handle_error - ERROR - Error captured in step 'paso_anterior_fallo': Archivo corrupto para usuario 'abc': Unterminated string
2025-10-26 22:59:20 - agents.nodes.handle_error - INFO - Generated user-friendly error message: ❌ Lo siento, hubo un problema: Hubo un problema al leer los datos de tu perfil. Podría estar corrupto.
(Referencia: paso 'paso_anterior_fallo')
2025-10-26 22:59:20 - agents.nodes.handle_error - INFO - --- Exiting Handle Error Node ---
2025-10-26 22:59:20 - agents.nodes.handle_error - INFO - --- Entering Handle Error Node ---
2025-10-26 22:59:20 - agents.nodes.handle_error - ERROR - Error captured in step 'paso_anterior_fallo': Alucinación detectada: principios extraídos sin citas
2025-10-26 22:59:20 - agents.nodes.handle_error - INFO - Generated user-friendly error message: ❌ Lo siento, hubo un problema: No pude verificar la información extraída del libro (faltan citas). No puedo proceder de forma segura.
(Referencia: paso 'paso_anterior_fallo')
2025-10-26 22:59:20 - agents.nodes.handle_error - INFO - --- Exiting Handle Error Node ---
2025-10-26 22:59:20 - agents.nodes.handle_error - INFO - --- Entering Handle Error Node ---
2025-10-26 22:59:20 - agents.nodes.handle_error - ERROR - Error captured in step 'paso_anterior_fallo': Validación fallida: RIR inconsistente
2025-10-26 22:59:20 - agents.nodes.handle_error - INFO - Generated user-friendly error message: ❌ Lo siento, hubo un problema: La rutina generada no respeta el RIR recomendado por el libro.
(Referencia: paso 'paso_anterior_fallo')
2025-10-26 22:59:20 - agents.nodes.handle_error - INFO - --- Exiting Handle Error Node ---
2025-10-26 22:59:20 - agents.nodes.handle_error - INFO - --- Entering Handle Error Node ---
2025-10-26 22:59:20 - agents.nodes.handle_error - ERROR - Error captured in step 'paso_anterior_fallo': Error de archivo guardando rutina: [Errno 13] Permission denied
2025-10-26 22:59:20 - agents.nodes.handle_error - INFO - Generated user-friendly error message: ❌ Lo siento, hubo un problema: Error del sistema al intentar guardar (problema de permisos).
(Referencia: paso 'paso_anterior_fallo')
2025-10-26 22:59:20 - agents.nodes.handle_error - INFO - --- Exiting Handle Error Node ---
2025-10-26 22:59:20 - agents.nodes.handle_error - INFO - --- Entering Handle Error Node ---
2025-10-26 22:59:20 - agents.nodes.handle_error - ERROR - Error captured in step 'paso_anterior_fallo': Error desconocido criptográfico
2025-10-26 22:59:20 - agents.nodes.handle_error - INFO - Generated user-friendly error message: ❌ Lo siento, hubo un problema: Ocurrió un error inesperado procesando tu solicitud.
(Referencia: paso 'paso_anterior_fallo')
2025-10-26 22:59:20 - agents.nodes.handle_error - INFO - --- Exiting Handle Error Node ---
2025-10-26 22:59:20 - agents.nodes.load_context - INFO - --- Entering Load Context Node ---
2025-10-26 22:59:20 - agents.nodes.load_context - INFO - Attempting to load user profile from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\data\users\test_user.json
2025-10-26 22:59:20 - agents.nodes.load_context - ERROR - User file not found for user_id: test_user at C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\data\users\test_user.json
2025-10-26 22:59:20 - agents.nodes.handle_error - INFO - --- Entering Handle Error Node ---
2025-10-26 22:59:20 - agents.nodes.handle_error - ERROR - Error captured in step '': Error simulado para prueba de handle_error
2025-10-26 22:59:20 - agents.nodes.handle_error - INFO - Generated user-friendly error message: ❌ Lo siento, hubo un problema: Ocurrió un error inesperado procesando tu solicitud.
(Referencia: paso '')
2025-10-26 22:59:20 - agents.nodes.handle_error - INFO - --- Exiting Handle Error Node ---
2025-10-26 22:59:20 - rag.vectorstore_manager - INFO - Loading existing vector store from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\data\chroma_db
2025-10-26 22:59:22 - rag.vectorstore_manager - INFO - ✅ Vector store loaded successfully.
2025-10-26 22:59:24 - rag.principle_extractor - INFO - PrincipleExtractor initialized.
2025-10-26 22:59:24 - rag.principle_extractor - INFO - Building the principle extraction RAG chain...
2025-10-26 22:59:24 - rag.principle_extractor - INFO - Loading prompt template from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\rag_principle_extractor.txt
2025-10-26 22:59:24 - rag.principle_extractor - INFO - Prompt template loaded successfully.
2025-10-26 22:59:24 - rag.vectorstore_manager - INFO - Loading existing vector store from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\data\chroma_db
2025-10-26 22:59:24 - rag.vectorstore_manager - INFO - ✅ Vector store loaded successfully.
2025-10-26 22:59:24 - rag.principle_extractor - INFO - Retriever obtained from vector store.
2025-10-26 22:59:24 - rag.principle_extractor - INFO - PromptTemplate instance created.
2025-10-26 22:59:24 - rag.principle_extractor - INFO - ✅ Principle extraction RAG chain built successfully.
2025-10-26 22:59:25 - rag.principle_extractor - INFO - PrincipleExtractor initialized.
2025-10-26 22:59:25 - rag.principle_extractor - INFO - Building the principle extraction RAG chain...
2025-10-26 22:59:25 - rag.principle_extractor - INFO - Loading prompt template from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\rag_principle_extractor.txt
2025-10-26 22:59:25 - rag.principle_extractor - INFO - Prompt template loaded successfully.
2025-10-26 22:59:25 - rag.vectorstore_manager - INFO - Loading existing vector store from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\data\chroma_db
2025-10-26 22:59:25 - rag.vectorstore_manager - INFO - ✅ Vector store loaded successfully.
2025-10-26 22:59:25 - rag.principle_extractor - INFO - Retriever obtained from vector store.
2025-10-26 22:59:25 - rag.principle_extractor - INFO - PromptTemplate instance created.
2025-10-26 22:59:25 - rag.principle_extractor - INFO - ✅ Principle extraction RAG chain built successfully.
2025-10-26 22:59:26 - rag.principle_extractor - INFO - PrincipleExtractor initialized.
2025-10-26 22:59:26 - rag.principle_extractor - INFO - Building the principle extraction RAG chain...
2025-10-26 22:59:26 - rag.principle_extractor - INFO - Loading prompt template from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\rag_principle_extractor.txt
2025-10-26 22:59:26 - rag.principle_extractor - INFO - Prompt template loaded successfully.
2025-10-26 22:59:26 - rag.vectorstore_manager - INFO - Loading existing vector store from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\data\chroma_db
2025-10-26 22:59:26 - rag.vectorstore_manager - INFO - ✅ Vector store loaded successfully.
2025-10-26 22:59:26 - rag.principle_extractor - INFO - Retriever obtained from vector store.
2025-10-26 22:59:26 - rag.principle_extractor - INFO - PromptTemplate instance created.
2025-10-26 22:59:26 - rag.principle_extractor - INFO - ✅ Principle extraction RAG chain built successfully.
2025-10-26 22:59:27 - rag.principle_extractor - INFO - PrincipleExtractor initialized.
2025-10-26 22:59:27 - rag.principle_extractor - INFO - Building the principle extraction RAG chain...
2025-10-26 22:59:27 - rag.principle_extractor - INFO - Loading prompt template from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\rag_principle_extractor.txt
2025-10-26 22:59:27 - rag.principle_extractor - INFO - Prompt template loaded successfully.
2025-10-26 22:59:27 - rag.vectorstore_manager - INFO - Loading existing vector store from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\data\chroma_db
2025-10-26 22:59:27 - rag.vectorstore_manager - INFO - ✅ Vector store loaded successfully.
2025-10-26 22:59:27 - rag.principle_extractor - INFO - Retriever obtained from vector store.
2025-10-26 22:59:27 - rag.principle_extractor - INFO - PromptTemplate instance created.
2025-10-26 22:59:27 - rag.principle_extractor - INFO - ✅ Principle extraction RAG chain built successfully.
2025-10-26 22:59:28 - rag.principle_extractor - INFO - PrincipleExtractor initialized.
2025-10-26 22:59:28 - rag.principle_extractor - INFO - Building the principle extraction RAG chain...
2025-10-26 22:59:28 - rag.principle_extractor - INFO - Loading prompt template from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\rag_principle_extractor.txt
2025-10-26 22:59:28 - rag.principle_extractor - INFO - Prompt template loaded successfully.
2025-10-26 22:59:28 - rag.vectorstore_manager - INFO - Loading existing vector store from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\data\chroma_db
2025-10-26 22:59:28 - rag.vectorstore_manager - INFO - ✅ Vector store loaded successfully.
2025-10-26 22:59:28 - rag.principle_extractor - INFO - Retriever obtained from vector store.
2025-10-26 22:59:28 - rag.principle_extractor - INFO - PromptTemplate instance created.
2025-10-26 22:59:28 - rag.principle_extractor - INFO - ✅ Principle extraction RAG chain built successfully.
2025-10-26 23:00:40 - rag.vectorstore_manager - INFO - Loading existing vector store from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\data\chroma_db
2025-10-26 23:00:42 - rag.vectorstore_manager - INFO - ✅ Vector store loaded successfully.
2025-10-26 23:00:47 - rag.principle_extractor - INFO - PrincipleExtractor initialized.
2025-10-26 23:00:47 - rag.principle_extractor - INFO - Building the principle extraction RAG chain...
2025-10-26 23:00:47 - rag.principle_extractor - INFO - Loading prompt template from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\rag_principle_extractor.txt
2025-10-26 23:00:47 - rag.principle_extractor - INFO - Prompt template loaded successfully.
2025-10-26 23:00:47 - rag.vectorstore_manager - INFO - Loading existing vector store from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\data\chroma_db
2025-10-26 23:00:47 - rag.vectorstore_manager - INFO - ✅ Vector store loaded successfully.
2025-10-26 23:00:47 - rag.principle_extractor - INFO - Retriever obtained from vector store.
2025-10-26 23:00:47 - rag.principle_extractor - INFO - PromptTemplate instance created.
2025-10-26 23:00:47 - rag.principle_extractor - INFO - ✅ Principle extraction RAG chain built successfully.
2025-10-26 23:00:49 - rag.principle_extractor - INFO - PrincipleExtractor initialized.
2025-10-26 23:00:49 - rag.principle_extractor - INFO - Building the principle extraction RAG chain...
2025-10-26 23:00:49 - rag.principle_extractor - INFO - Loading prompt template from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\rag_principle_extractor.txt
2025-10-26 23:00:49 - rag.principle_extractor - INFO - Prompt template loaded successfully.
2025-10-26 23:00:49 - rag.vectorstore_manager - INFO - Loading existing vector store from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\data\chroma_db
2025-10-26 23:00:49 - rag.vectorstore_manager - INFO - ✅ Vector store loaded successfully.
2025-10-26 23:00:49 - rag.principle_extractor - INFO - Retriever obtained from vector store.
2025-10-26 23:00:49 - rag.principle_extractor - INFO - PromptTemplate instance created.
2025-10-26 23:00:49 - rag.principle_extractor - INFO - ✅ Principle extraction RAG chain built successfully.
2025-10-26 23:00:50 - rag.principle_extractor - INFO - PrincipleExtractor initialized.
2025-10-26 23:00:50 - rag.principle_extractor - INFO - Building the principle extraction RAG chain...
2025-10-26 23:00:50 - rag.principle_extractor - INFO - Loading prompt template from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\rag_principle_extractor.txt
2025-10-26 23:00:50 - rag.principle_extractor - INFO - Prompt template loaded successfully.
2025-10-26 23:00:50 - rag.vectorstore_manager - INFO - Loading existing vector store from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\data\chroma_db
2025-10-26 23:00:50 - rag.vectorstore_manager - INFO - ✅ Vector store loaded successfully.
2025-10-26 23:00:50 - rag.principle_extractor - INFO - Retriever obtained from vector store.
2025-10-26 23:00:50 - rag.principle_extractor - INFO - PromptTemplate instance created.
2025-10-26 23:00:50 - rag.principle_extractor - INFO - ✅ Principle extraction RAG chain built successfully.
2025-10-26 23:00:51 - rag.principle_extractor - INFO - PrincipleExtractor initialized.
2025-10-26 23:00:51 - rag.principle_extractor - INFO - Building the principle extraction RAG chain...
2025-10-26 23:00:51 - rag.principle_extractor - INFO - Loading prompt template from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\rag_principle_extractor.txt
2025-10-26 23:00:51 - rag.principle_extractor - INFO - Prompt template loaded successfully.
2025-10-26 23:00:51 - rag.vectorstore_manager - INFO - Loading existing vector store from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\data\chroma_db
2025-10-26 23:00:51 - rag.vectorstore_manager - INFO - ✅ Vector store loaded successfully.
2025-10-26 23:00:51 - rag.principle_extractor - INFO - Retriever obtained from vector store.
2025-10-26 23:00:51 - rag.principle_extractor - INFO - PromptTemplate instance created.
2025-10-26 23:00:51 - rag.principle_extractor - INFO - ✅ Principle extraction RAG chain built successfully.
2025-10-26 23:00:52 - rag.principle_extractor - INFO - PrincipleExtractor initialized.
2025-10-26 23:00:52 - rag.principle_extractor - INFO - Building the principle extraction RAG chain...
2025-10-26 23:00:52 - rag.principle_extractor - INFO - Loading prompt template from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\rag_principle_extractor.txt
2025-10-26 23:00:52 - rag.principle_extractor - INFO - Prompt template loaded successfully.
2025-10-26 23:00:52 - rag.vectorstore_manager - INFO - Loading existing vector store from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\data\chroma_db
2025-10-26 23:00:52 - rag.vectorstore_manager - INFO - ✅ Vector store loaded successfully.
2025-10-26 23:00:52 - rag.principle_extractor - INFO - Retriever obtained from vector store.
2025-10-26 23:00:52 - rag.principle_extractor - INFO - PromptTemplate instance created.
2025-10-26 23:00:52 - rag.principle_extractor - INFO - ✅ Principle extraction RAG chain built successfully.
