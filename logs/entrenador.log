2025-10-26 19:06:48 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 19:06:48 - agents.nodes.generate_routine - INFO - Loading routine assembler prompt from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\routine_assembler.txt
2025-10-26 19:06:50 - agents.nodes.generate_routine - INFO - Routine generation chain built.
2025-10-26 19:06:50 - agents.nodes.generate_routine - INFO - Routine generation chain built.
2025-10-26 19:06:50 - agents.nodes.generate_routine - INFO - Attempt 1/3 to generate routine...
2025-10-26 19:06:50 - agents.nodes.generate_routine - ERROR - Attempt 1 failed with unexpected error: 'RutinaActiva' object has no attribute 'additional_kwargs'
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 149, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 5492, in invoke
    return self.bound.invoke(
           ~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
        self._merge_configs(config),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **{**self.kwargs, **kwargs},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 4815, in invoke
    return self._call_with_config(
           ~~~~~~~~~~~~~~~~~~~~~~^
        self._invoke,
        ^^^^^^^^^^^^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 2021, in _call_with_config
    context.run(
    ~~~~~~~~~~~^
        call_func_with_variable_args,  # type: ignore[arg-type]
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
        **kwargs,
        ^^^^^^^^^
    ),
    ^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\config.py", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 4672, in _invoke
    output = call_func_with_variable_args(
        self.func, input_, config, run_manager, **kwargs
    )
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\config.py", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_openai\chat_models\base.py", line 3450, in _oai_structured_outputs_parser
    if parsed := ai_msg.additional_kwargs.get("parsed"):
                 ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\pydantic\main.py", line 1026, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'RutinaActiva' object has no attribute 'additional_kwargs'
2025-10-26 19:06:51 - agents.nodes.generate_routine - INFO - Attempt 2/3 to generate routine...
2025-10-26 19:06:51 - agents.nodes.generate_routine - ERROR - Attempt 2 failed with unexpected error: 'RutinaActiva' object has no attribute 'additional_kwargs'
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 149, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 5492, in invoke
    return self.bound.invoke(
           ~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
        self._merge_configs(config),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **{**self.kwargs, **kwargs},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 4815, in invoke
    return self._call_with_config(
           ~~~~~~~~~~~~~~~~~~~~~~^
        self._invoke,
        ^^^^^^^^^^^^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 2021, in _call_with_config
    context.run(
    ~~~~~~~~~~~^
        call_func_with_variable_args,  # type: ignore[arg-type]
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
        **kwargs,
        ^^^^^^^^^
    ),
    ^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\config.py", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 4672, in _invoke
    output = call_func_with_variable_args(
        self.func, input_, config, run_manager, **kwargs
    )
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\config.py", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_openai\chat_models\base.py", line 3450, in _oai_structured_outputs_parser
    if parsed := ai_msg.additional_kwargs.get("parsed"):
                 ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\pydantic\main.py", line 1026, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'RutinaActiva' object has no attribute 'additional_kwargs'
2025-10-26 19:06:52 - agents.nodes.generate_routine - INFO - Attempt 3/3 to generate routine...
2025-10-26 19:06:52 - agents.nodes.generate_routine - ERROR - Attempt 3 failed with unexpected error: 'RutinaActiva' object has no attribute 'additional_kwargs'
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 149, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 5492, in invoke
    return self.bound.invoke(
           ~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
        self._merge_configs(config),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **{**self.kwargs, **kwargs},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 4815, in invoke
    return self._call_with_config(
           ~~~~~~~~~~~~~~~~~~~~~~^
        self._invoke,
        ^^^^^^^^^^^^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 2021, in _call_with_config
    context.run(
    ~~~~~~~~~~~^
        call_func_with_variable_args,  # type: ignore[arg-type]
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
        **kwargs,
        ^^^^^^^^^
    ),
    ^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\config.py", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 4672, in _invoke
    output = call_func_with_variable_args(
        self.func, input_, config, run_manager, **kwargs
    )
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\config.py", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_openai\chat_models\base.py", line 3450, in _oai_structured_outputs_parser
    if parsed := ai_msg.additional_kwargs.get("parsed"):
                 ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\pydantic\main.py", line 1026, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'RutinaActiva' object has no attribute 'additional_kwargs'
2025-10-26 19:06:53 - agents.nodes.generate_routine - ERROR - Failed to generate valid routine after 3 attempts.
2025-10-26 19:06:53 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 19:06:53 - agents.nodes.generate_routine - ERROR - 'principios_libro' missing in state.
2025-10-26 19:06:53 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 19:06:53 - agents.nodes.generate_routine - INFO - Loading routine assembler prompt from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\routine_assembler.txt
2025-10-26 19:06:53 - agents.nodes.generate_routine - INFO - Routine generation chain built.
2025-10-26 19:06:53 - agents.nodes.generate_routine - INFO - Routine generation chain built.
2025-10-26 19:06:53 - agents.nodes.generate_routine - INFO - Attempt 1/3 to generate routine...
2025-10-26 19:06:53 - agents.nodes.generate_routine - ERROR - Attempt 1 failed with unexpected error: 'RutinaActiva' object has no attribute 'additional_kwargs'
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 149, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 5492, in invoke
    return self.bound.invoke(
           ~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
        self._merge_configs(config),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **{**self.kwargs, **kwargs},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 4815, in invoke
    return self._call_with_config(
           ~~~~~~~~~~~~~~~~~~~~~~^
        self._invoke,
        ^^^^^^^^^^^^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 2021, in _call_with_config
    context.run(
    ~~~~~~~~~~~^
        call_func_with_variable_args,  # type: ignore[arg-type]
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
        **kwargs,
        ^^^^^^^^^
    ),
    ^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\config.py", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 4672, in _invoke
    output = call_func_with_variable_args(
        self.func, input_, config, run_manager, **kwargs
    )
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\config.py", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_openai\chat_models\base.py", line 3450, in _oai_structured_outputs_parser
    if parsed := ai_msg.additional_kwargs.get("parsed"):
                 ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\pydantic\main.py", line 1026, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'RutinaActiva' object has no attribute 'additional_kwargs'
2025-10-26 19:06:54 - agents.nodes.generate_routine - INFO - Attempt 2/3 to generate routine...
2025-10-26 19:06:54 - agents.nodes.generate_routine - ERROR - Attempt 2 failed with unexpected error: 'RutinaActiva' object has no attribute 'additional_kwargs'
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 149, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 5492, in invoke
    return self.bound.invoke(
           ~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
        self._merge_configs(config),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **{**self.kwargs, **kwargs},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 4815, in invoke
    return self._call_with_config(
           ~~~~~~~~~~~~~~~~~~~~~~^
        self._invoke,
        ^^^^^^^^^^^^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 2021, in _call_with_config
    context.run(
    ~~~~~~~~~~~^
        call_func_with_variable_args,  # type: ignore[arg-type]
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
        **kwargs,
        ^^^^^^^^^
    ),
    ^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\config.py", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 4672, in _invoke
    output = call_func_with_variable_args(
        self.func, input_, config, run_manager, **kwargs
    )
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\config.py", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_openai\chat_models\base.py", line 3450, in _oai_structured_outputs_parser
    if parsed := ai_msg.additional_kwargs.get("parsed"):
                 ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\pydantic\main.py", line 1026, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'RutinaActiva' object has no attribute 'additional_kwargs'
2025-10-26 19:06:55 - agents.nodes.generate_routine - INFO - Attempt 3/3 to generate routine...
2025-10-26 19:06:55 - agents.nodes.generate_routine - ERROR - Attempt 3 failed with unexpected error: 'RutinaActiva' object has no attribute 'additional_kwargs'
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 149, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 5492, in invoke
    return self.bound.invoke(
           ~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
        self._merge_configs(config),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **{**self.kwargs, **kwargs},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 4815, in invoke
    return self._call_with_config(
           ~~~~~~~~~~~~~~~~~~~~~~^
        self._invoke,
        ^^^^^^^^^^^^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 2021, in _call_with_config
    context.run(
    ~~~~~~~~~~~^
        call_func_with_variable_args,  # type: ignore[arg-type]
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
        **kwargs,
        ^^^^^^^^^
    ),
    ^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\config.py", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 4672, in _invoke
    output = call_func_with_variable_args(
        self.func, input_, config, run_manager, **kwargs
    )
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\config.py", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_openai\chat_models\base.py", line 3450, in _oai_structured_outputs_parser
    if parsed := ai_msg.additional_kwargs.get("parsed"):
                 ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\pydantic\main.py", line 1026, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'RutinaActiva' object has no attribute 'additional_kwargs'
2025-10-26 19:06:56 - agents.nodes.generate_routine - ERROR - Failed to generate valid routine after 3 attempts.
2025-10-26 21:27:45 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 21:27:45 - agents.nodes.generate_routine - INFO - Loading routine assembler prompt from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\routine_assembler.txt
2025-10-26 21:27:46 - agents.nodes.generate_routine - INFO - Routine generation chain built.
2025-10-26 21:27:46 - agents.nodes.generate_routine - INFO - Attempt 1/3 to generate routine...
2025-10-26 21:27:46 - agents.nodes.generate_routine - ERROR - Attempt 1 failed with unexpected error: 1 validation error for Generation
text
  Input should be a valid string [type=string_type, input_value=RutinaActiva(nombre='Ruti...675', validez_semanas=4), input_type=RutinaActiva]
    For further information visit https://errors.pydantic.dev/2.12/v/string_type
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\output_parsers\base.py", line 205, in invoke
    return self._call_with_config(
           ~~~~~~~~~~~~~~~~~~~~~~^
        lambda inner_input: self.parse_result([Generation(text=inner_input)]),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        run_type="parser",
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 2021, in _call_with_config
    context.run(
    ~~~~~~~~~~~^
        call_func_with_variable_args,  # type: ignore[arg-type]
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
        **kwargs,
        ^^^^^^^^^
    ),
    ^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\config.py", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\output_parsers\base.py", line 206, in <lambda>
    lambda inner_input: self.parse_result([Generation(text=inner_input)]),
                                           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\load\serializable.py", line 113, in __init__
    super().__init__(*args, **kwargs)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\pydantic\main.py", line 250, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 1 validation error for Generation
text
  Input should be a valid string [type=string_type, input_value=RutinaActiva(nombre='Ruti...675', validez_semanas=4), input_type=RutinaActiva]
    For further information visit https://errors.pydantic.dev/2.12/v/string_type
2025-10-26 21:27:47 - agents.nodes.generate_routine - INFO - Attempt 2/3 to generate routine...
2025-10-26 21:27:47 - agents.nodes.generate_routine - ERROR - Attempt 2 failed with unexpected error: 1 validation error for Generation
text
  Input should be a valid string [type=string_type, input_value=RutinaActiva(nombre='Ruti...256', validez_semanas=4), input_type=RutinaActiva]
    For further information visit https://errors.pydantic.dev/2.12/v/string_type
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\output_parsers\base.py", line 205, in invoke
    return self._call_with_config(
           ~~~~~~~~~~~~~~~~~~~~~~^
        lambda inner_input: self.parse_result([Generation(text=inner_input)]),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        run_type="parser",
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 2021, in _call_with_config
    context.run(
    ~~~~~~~~~~~^
        call_func_with_variable_args,  # type: ignore[arg-type]
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
        **kwargs,
        ^^^^^^^^^
    ),
    ^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\config.py", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\output_parsers\base.py", line 206, in <lambda>
    lambda inner_input: self.parse_result([Generation(text=inner_input)]),
                                           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\load\serializable.py", line 113, in __init__
    super().__init__(*args, **kwargs)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\pydantic\main.py", line 250, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 1 validation error for Generation
text
  Input should be a valid string [type=string_type, input_value=RutinaActiva(nombre='Ruti...256', validez_semanas=4), input_type=RutinaActiva]
    For further information visit https://errors.pydantic.dev/2.12/v/string_type
2025-10-26 21:27:48 - agents.nodes.generate_routine - INFO - Attempt 3/3 to generate routine...
2025-10-26 21:27:48 - agents.nodes.generate_routine - ERROR - Attempt 3 failed with unexpected error: 1 validation error for Generation
text
  Input should be a valid string [type=string_type, input_value=RutinaActiva(nombre='Ruti...076', validez_semanas=4), input_type=RutinaActiva]
    For further information visit https://errors.pydantic.dev/2.12/v/string_type
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\output_parsers\base.py", line 205, in invoke
    return self._call_with_config(
           ~~~~~~~~~~~~~~~~~~~~~~^
        lambda inner_input: self.parse_result([Generation(text=inner_input)]),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        run_type="parser",
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 2021, in _call_with_config
    context.run(
    ~~~~~~~~~~~^
        call_func_with_variable_args,  # type: ignore[arg-type]
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
        **kwargs,
        ^^^^^^^^^
    ),
    ^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\config.py", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\output_parsers\base.py", line 206, in <lambda>
    lambda inner_input: self.parse_result([Generation(text=inner_input)]),
                                           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\load\serializable.py", line 113, in __init__
    super().__init__(*args, **kwargs)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\pydantic\main.py", line 250, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 1 validation error for Generation
text
  Input should be a valid string [type=string_type, input_value=RutinaActiva(nombre='Ruti...076', validez_semanas=4), input_type=RutinaActiva]
    For further information visit https://errors.pydantic.dev/2.12/v/string_type
2025-10-26 21:27:49 - agents.nodes.generate_routine - ERROR - Failed to generate valid routine after 3 attempts.
2025-10-26 21:27:50 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 21:27:50 - agents.nodes.generate_routine - ERROR - 'principios_libro' missing in state.
2025-10-26 21:27:50 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 21:27:50 - agents.nodes.generate_routine - INFO - Loading routine assembler prompt from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\routine_assembler.txt
2025-10-26 21:27:50 - agents.nodes.generate_routine - INFO - Routine generation chain built.
2025-10-26 21:27:50 - agents.nodes.generate_routine - INFO - Attempt 1/3 to generate routine...
2025-10-26 21:27:50 - agents.nodes.generate_routine - ERROR - Attempt 1 failed with unexpected error: 1 validation error for Generation
text
  Input should be a valid string [type=string_type, input_value=RutinaActiva(nombre='Ruti...781', validez_semanas=4), input_type=RutinaActiva]
    For further information visit https://errors.pydantic.dev/2.12/v/string_type
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\output_parsers\base.py", line 205, in invoke
    return self._call_with_config(
           ~~~~~~~~~~~~~~~~~~~~~~^
        lambda inner_input: self.parse_result([Generation(text=inner_input)]),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        run_type="parser",
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 2021, in _call_with_config
    context.run(
    ~~~~~~~~~~~^
        call_func_with_variable_args,  # type: ignore[arg-type]
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
        **kwargs,
        ^^^^^^^^^
    ),
    ^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\config.py", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\output_parsers\base.py", line 206, in <lambda>
    lambda inner_input: self.parse_result([Generation(text=inner_input)]),
                                           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\load\serializable.py", line 113, in __init__
    super().__init__(*args, **kwargs)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\pydantic\main.py", line 250, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 1 validation error for Generation
text
  Input should be a valid string [type=string_type, input_value=RutinaActiva(nombre='Ruti...781', validez_semanas=4), input_type=RutinaActiva]
    For further information visit https://errors.pydantic.dev/2.12/v/string_type
2025-10-26 21:27:51 - agents.nodes.generate_routine - INFO - Attempt 2/3 to generate routine...
2025-10-26 21:27:51 - agents.nodes.generate_routine - ERROR - Attempt 2 failed with unexpected error: 1 validation error for Generation
text
  Input should be a valid string [type=string_type, input_value=RutinaActiva(nombre='Ruti...424', validez_semanas=4), input_type=RutinaActiva]
    For further information visit https://errors.pydantic.dev/2.12/v/string_type
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\output_parsers\base.py", line 205, in invoke
    return self._call_with_config(
           ~~~~~~~~~~~~~~~~~~~~~~^
        lambda inner_input: self.parse_result([Generation(text=inner_input)]),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        run_type="parser",
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 2021, in _call_with_config
    context.run(
    ~~~~~~~~~~~^
        call_func_with_variable_args,  # type: ignore[arg-type]
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
        **kwargs,
        ^^^^^^^^^
    ),
    ^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\config.py", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\output_parsers\base.py", line 206, in <lambda>
    lambda inner_input: self.parse_result([Generation(text=inner_input)]),
                                           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\load\serializable.py", line 113, in __init__
    super().__init__(*args, **kwargs)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\pydantic\main.py", line 250, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 1 validation error for Generation
text
  Input should be a valid string [type=string_type, input_value=RutinaActiva(nombre='Ruti...424', validez_semanas=4), input_type=RutinaActiva]
    For further information visit https://errors.pydantic.dev/2.12/v/string_type
2025-10-26 21:27:52 - agents.nodes.generate_routine - INFO - Attempt 3/3 to generate routine...
2025-10-26 21:27:52 - agents.nodes.generate_routine - ERROR - Attempt 3 failed with unexpected error: 1 validation error for Generation
text
  Input should be a valid string [type=string_type, input_value=RutinaActiva(nombre='Ruti...829', validez_semanas=4), input_type=RutinaActiva]
    For further information visit https://errors.pydantic.dev/2.12/v/string_type
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\output_parsers\base.py", line 205, in invoke
    return self._call_with_config(
           ~~~~~~~~~~~~~~~~~~~~~~^
        lambda inner_input: self.parse_result([Generation(text=inner_input)]),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        run_type="parser",
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 2021, in _call_with_config
    context.run(
    ~~~~~~~~~~~^
        call_func_with_variable_args,  # type: ignore[arg-type]
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
        **kwargs,
        ^^^^^^^^^
    ),
    ^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\config.py", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\output_parsers\base.py", line 206, in <lambda>
    lambda inner_input: self.parse_result([Generation(text=inner_input)]),
                                           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\load\serializable.py", line 113, in __init__
    super().__init__(*args, **kwargs)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\pydantic\main.py", line 250, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 1 validation error for Generation
text
  Input should be a valid string [type=string_type, input_value=RutinaActiva(nombre='Ruti...829', validez_semanas=4), input_type=RutinaActiva]
    For further information visit https://errors.pydantic.dev/2.12/v/string_type
2025-10-26 21:27:53 - agents.nodes.generate_routine - ERROR - Failed to generate valid routine after 3 attempts.
2025-10-26 21:28:55 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 21:28:55 - agents.nodes.generate_routine - INFO - Loading routine assembler prompt from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\routine_assembler.txt
2025-10-26 21:28:57 - agents.nodes.generate_routine - INFO - Routine generation chain built.
2025-10-26 21:28:57 - agents.nodes.generate_routine - INFO - Attempt 1/3 to generate routine...
2025-10-26 21:28:57 - agents.nodes.generate_routine - ERROR - Attempt 1 failed with unexpected error: 1 validation error for Generation
text
  Input should be a valid string [type=string_type, input_value=RutinaActiva(nombre='Ruti...385', validez_semanas=4), input_type=RutinaActiva]
    For further information visit https://errors.pydantic.dev/2.12/v/string_type
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\output_parsers\base.py", line 205, in invoke
    return self._call_with_config(
           ~~~~~~~~~~~~~~~~~~~~~~^
        lambda inner_input: self.parse_result([Generation(text=inner_input)]),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        run_type="parser",
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 2021, in _call_with_config
    context.run(
    ~~~~~~~~~~~^
        call_func_with_variable_args,  # type: ignore[arg-type]
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
        **kwargs,
        ^^^^^^^^^
    ),
    ^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\config.py", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\output_parsers\base.py", line 206, in <lambda>
    lambda inner_input: self.parse_result([Generation(text=inner_input)]),
                                           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\load\serializable.py", line 113, in __init__
    super().__init__(*args, **kwargs)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\pydantic\main.py", line 250, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 1 validation error for Generation
text
  Input should be a valid string [type=string_type, input_value=RutinaActiva(nombre='Ruti...385', validez_semanas=4), input_type=RutinaActiva]
    For further information visit https://errors.pydantic.dev/2.12/v/string_type
2025-10-26 21:28:58 - agents.nodes.generate_routine - INFO - Attempt 2/3 to generate routine...
2025-10-26 21:28:58 - agents.nodes.generate_routine - ERROR - Attempt 2 failed with unexpected error: 1 validation error for Generation
text
  Input should be a valid string [type=string_type, input_value=RutinaActiva(nombre='Ruti...320', validez_semanas=4), input_type=RutinaActiva]
    For further information visit https://errors.pydantic.dev/2.12/v/string_type
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\output_parsers\base.py", line 205, in invoke
    return self._call_with_config(
           ~~~~~~~~~~~~~~~~~~~~~~^
        lambda inner_input: self.parse_result([Generation(text=inner_input)]),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        run_type="parser",
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 2021, in _call_with_config
    context.run(
    ~~~~~~~~~~~^
        call_func_with_variable_args,  # type: ignore[arg-type]
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
        **kwargs,
        ^^^^^^^^^
    ),
    ^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\config.py", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\output_parsers\base.py", line 206, in <lambda>
    lambda inner_input: self.parse_result([Generation(text=inner_input)]),
                                           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\load\serializable.py", line 113, in __init__
    super().__init__(*args, **kwargs)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\pydantic\main.py", line 250, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 1 validation error for Generation
text
  Input should be a valid string [type=string_type, input_value=RutinaActiva(nombre='Ruti...320', validez_semanas=4), input_type=RutinaActiva]
    For further information visit https://errors.pydantic.dev/2.12/v/string_type
2025-10-26 21:28:59 - agents.nodes.generate_routine - INFO - Attempt 3/3 to generate routine...
2025-10-26 21:28:59 - agents.nodes.generate_routine - ERROR - Attempt 3 failed with unexpected error: 1 validation error for Generation
text
  Input should be a valid string [type=string_type, input_value=RutinaActiva(nombre='Ruti...411', validez_semanas=4), input_type=RutinaActiva]
    For further information visit https://errors.pydantic.dev/2.12/v/string_type
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\output_parsers\base.py", line 205, in invoke
    return self._call_with_config(
           ~~~~~~~~~~~~~~~~~~~~~~^
        lambda inner_input: self.parse_result([Generation(text=inner_input)]),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        run_type="parser",
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 2021, in _call_with_config
    context.run(
    ~~~~~~~~~~~^
        call_func_with_variable_args,  # type: ignore[arg-type]
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
        **kwargs,
        ^^^^^^^^^
    ),
    ^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\config.py", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\output_parsers\base.py", line 206, in <lambda>
    lambda inner_input: self.parse_result([Generation(text=inner_input)]),
                                           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\load\serializable.py", line 113, in __init__
    super().__init__(*args, **kwargs)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\pydantic\main.py", line 250, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 1 validation error for Generation
text
  Input should be a valid string [type=string_type, input_value=RutinaActiva(nombre='Ruti...411', validez_semanas=4), input_type=RutinaActiva]
    For further information visit https://errors.pydantic.dev/2.12/v/string_type
2025-10-26 21:29:00 - agents.nodes.generate_routine - ERROR - Failed to generate valid routine after 3 attempts.
2025-10-26 21:29:00 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 21:29:00 - agents.nodes.generate_routine - ERROR - 'principios_libro' missing in state.
2025-10-26 21:29:00 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 21:29:00 - agents.nodes.generate_routine - INFO - Loading routine assembler prompt from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\routine_assembler.txt
2025-10-26 21:29:00 - agents.nodes.generate_routine - INFO - Routine generation chain built.
2025-10-26 21:29:00 - agents.nodes.generate_routine - INFO - Attempt 1/3 to generate routine...
2025-10-26 21:29:00 - agents.nodes.generate_routine - ERROR - Attempt 1 failed with unexpected error: 1 validation error for Generation
text
  Input should be a valid string [type=string_type, input_value=RutinaActiva(nombre='Ruti...985', validez_semanas=4), input_type=RutinaActiva]
    For further information visit https://errors.pydantic.dev/2.12/v/string_type
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\output_parsers\base.py", line 205, in invoke
    return self._call_with_config(
           ~~~~~~~~~~~~~~~~~~~~~~^
        lambda inner_input: self.parse_result([Generation(text=inner_input)]),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        run_type="parser",
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 2021, in _call_with_config
    context.run(
    ~~~~~~~~~~~^
        call_func_with_variable_args,  # type: ignore[arg-type]
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
        **kwargs,
        ^^^^^^^^^
    ),
    ^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\config.py", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\output_parsers\base.py", line 206, in <lambda>
    lambda inner_input: self.parse_result([Generation(text=inner_input)]),
                                           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\load\serializable.py", line 113, in __init__
    super().__init__(*args, **kwargs)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\pydantic\main.py", line 250, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 1 validation error for Generation
text
  Input should be a valid string [type=string_type, input_value=RutinaActiva(nombre='Ruti...985', validez_semanas=4), input_type=RutinaActiva]
    For further information visit https://errors.pydantic.dev/2.12/v/string_type
2025-10-26 21:29:01 - agents.nodes.generate_routine - INFO - Attempt 2/3 to generate routine...
2025-10-26 21:29:01 - agents.nodes.generate_routine - ERROR - Attempt 2 failed with unexpected error: 1 validation error for Generation
text
  Input should be a valid string [type=string_type, input_value=RutinaActiva(nombre='Ruti...626', validez_semanas=4), input_type=RutinaActiva]
    For further information visit https://errors.pydantic.dev/2.12/v/string_type
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\output_parsers\base.py", line 205, in invoke
    return self._call_with_config(
           ~~~~~~~~~~~~~~~~~~~~~~^
        lambda inner_input: self.parse_result([Generation(text=inner_input)]),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        run_type="parser",
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 2021, in _call_with_config
    context.run(
    ~~~~~~~~~~~^
        call_func_with_variable_args,  # type: ignore[arg-type]
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
        **kwargs,
        ^^^^^^^^^
    ),
    ^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\config.py", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\output_parsers\base.py", line 206, in <lambda>
    lambda inner_input: self.parse_result([Generation(text=inner_input)]),
                                           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\load\serializable.py", line 113, in __init__
    super().__init__(*args, **kwargs)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\pydantic\main.py", line 250, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 1 validation error for Generation
text
  Input should be a valid string [type=string_type, input_value=RutinaActiva(nombre='Ruti...626', validez_semanas=4), input_type=RutinaActiva]
    For further information visit https://errors.pydantic.dev/2.12/v/string_type
2025-10-26 21:29:02 - agents.nodes.generate_routine - INFO - Attempt 3/3 to generate routine...
2025-10-26 21:29:02 - agents.nodes.generate_routine - ERROR - Attempt 3 failed with unexpected error: 1 validation error for Generation
text
  Input should be a valid string [type=string_type, input_value=RutinaActiva(nombre='Ruti...757', validez_semanas=4), input_type=RutinaActiva]
    For further information visit https://errors.pydantic.dev/2.12/v/string_type
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\output_parsers\base.py", line 205, in invoke
    return self._call_with_config(
           ~~~~~~~~~~~~~~~~~~~~~~^
        lambda inner_input: self.parse_result([Generation(text=inner_input)]),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        run_type="parser",
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 2021, in _call_with_config
    context.run(
    ~~~~~~~~~~~^
        call_func_with_variable_args,  # type: ignore[arg-type]
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
        **kwargs,
        ^^^^^^^^^
    ),
    ^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\config.py", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\output_parsers\base.py", line 206, in <lambda>
    lambda inner_input: self.parse_result([Generation(text=inner_input)]),
                                           ~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\load\serializable.py", line 113, in __init__
    super().__init__(*args, **kwargs)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\pydantic\main.py", line 250, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 1 validation error for Generation
text
  Input should be a valid string [type=string_type, input_value=RutinaActiva(nombre='Ruti...757', validez_semanas=4), input_type=RutinaActiva]
    For further information visit https://errors.pydantic.dev/2.12/v/string_type
2025-10-26 21:29:03 - agents.nodes.generate_routine - ERROR - Failed to generate valid routine after 3 attempts.
2025-10-26 21:45:39 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 21:45:39 - agents.nodes.generate_routine - INFO - Loading routine assembler prompt from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\routine_assembler.txt
2025-10-26 21:45:40 - agents.nodes.generate_routine - INFO - Routine generation chain built.
2025-10-26 21:45:40 - agents.nodes.generate_routine - INFO - Attempt 1/3 to generate routine...
2025-10-26 21:45:40 - agents.nodes.generate_routine - INFO - LLM invocation successful.
2025-10-26 21:45:40 - agents.nodes.generate_routine - INFO - Successfully generated and validated routine in 1.31 seconds.
2025-10-26 21:45:40 - agents.nodes.generate_routine - ERROR - An unexpected error occurred during routine generation: 'NoneType' object does not support item assignment
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 194, in generate_routine
    state["debug_info"]["generation_metadata"] = metadata
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
TypeError: 'NoneType' object does not support item assignment
2025-10-26 21:45:40 - agents.nodes.generate_routine - INFO - --- Exiting Generate Routine Node ---
2025-10-26 21:51:31 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 21:51:31 - agents.nodes.generate_routine - INFO - Loading routine assembler prompt from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\routine_assembler.txt
2025-10-26 21:51:32 - agents.nodes.generate_routine - INFO - Routine generation chain built.
2025-10-26 21:51:32 - agents.nodes.generate_routine - INFO - Attempt 1/3 to generate routine...
2025-10-26 21:51:32 - agents.nodes.generate_routine - INFO - LLM invocation successful.
2025-10-26 21:51:32 - agents.nodes.generate_routine - INFO - Successfully generated and validated routine in 1.28 seconds.
2025-10-26 21:51:32 - agents.nodes.generate_routine - INFO - --- Exiting Generate Routine Node ---
2025-10-26 21:51:42 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 21:51:42 - agents.nodes.generate_routine - INFO - Loading routine assembler prompt from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\routine_assembler.txt
2025-10-26 21:51:43 - agents.nodes.generate_routine - INFO - Routine generation chain built.
2025-10-26 21:51:43 - agents.nodes.generate_routine - INFO - Attempt 1/3 to generate routine...
2025-10-26 21:51:43 - agents.nodes.generate_routine - INFO - LLM invocation successful.
2025-10-26 21:51:43 - agents.nodes.generate_routine - INFO - Successfully generated and validated routine in 1.26 seconds.
2025-10-26 21:51:43 - agents.nodes.generate_routine - INFO - --- Exiting Generate Routine Node ---
2025-10-26 21:51:43 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 21:51:43 - agents.nodes.generate_routine - ERROR - 'principios_libro' missing in state.
2025-10-26 21:51:43 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 21:51:43 - agents.nodes.generate_routine - INFO - Loading routine assembler prompt from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\routine_assembler.txt
2025-10-26 21:51:43 - agents.nodes.generate_routine - INFO - Routine generation chain built.
2025-10-26 21:51:43 - agents.nodes.generate_routine - INFO - Attempt 1/3 to generate routine...
2025-10-26 21:51:43 - agents.nodes.generate_routine - INFO - LLM invocation successful.
2025-10-26 21:51:43 - agents.nodes.generate_routine - INFO - Successfully generated and validated routine in 0.01 seconds.
2025-10-26 21:51:43 - agents.nodes.generate_routine - INFO - --- Exiting Generate Routine Node ---
2025-10-26 21:51:56 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 21:51:56 - agents.nodes.generate_routine - INFO - Loading routine assembler prompt from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\routine_assembler.txt
2025-10-26 21:51:58 - agents.nodes.generate_routine - INFO - Routine generation chain built.
2025-10-26 21:51:58 - agents.nodes.generate_routine - INFO - Attempt 1/3 to generate routine...
2025-10-26 21:51:58 - agents.nodes.generate_routine - INFO - LLM invocation successful.
2025-10-26 21:51:58 - agents.nodes.generate_routine - INFO - Successfully generated and validated routine in 1.28 seconds.
2025-10-26 21:51:58 - agents.nodes.generate_routine - INFO - --- Exiting Generate Routine Node ---
2025-10-26 21:51:58 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 21:51:58 - agents.nodes.generate_routine - ERROR - 'principios_libro' missing in state.
2025-10-26 21:51:58 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 21:51:58 - agents.nodes.generate_routine - INFO - Loading routine assembler prompt from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\routine_assembler.txt
2025-10-26 21:51:58 - agents.nodes.generate_routine - INFO - Routine generation chain built.
2025-10-26 21:51:58 - agents.nodes.generate_routine - INFO - Attempt 1/3 to generate routine...
2025-10-26 21:51:58 - agents.nodes.generate_routine - INFO - LLM invocation successful.
2025-10-26 21:51:58 - agents.nodes.generate_routine - INFO - Successfully generated and validated routine in 0.01 seconds.
2025-10-26 21:51:58 - agents.nodes.generate_routine - INFO - --- Exiting Generate Routine Node ---
2025-10-26 21:54:22 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 21:54:22 - agents.nodes.generate_routine - INFO - Loading routine assembler prompt from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\routine_assembler.txt
2025-10-26 21:54:23 - agents.nodes.generate_routine - INFO - Routine generation chain built.
2025-10-26 21:54:23 - agents.nodes.generate_routine - INFO - Attempt 1/3 to generate routine...
2025-10-26 21:54:23 - agents.nodes.generate_routine - ERROR - Attempt 1 failed with unexpected error: cannot access local variable 'content_str' where it is not associated with a value
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 326, in mock_invoke
    if isinstance(content_str, str):
                  ^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'content_str' where it is not associated with a value
2025-10-26 21:54:24 - agents.nodes.generate_routine - INFO - Attempt 2/3 to generate routine...
2025-10-26 21:54:24 - agents.nodes.generate_routine - ERROR - Attempt 2 failed with unexpected error: cannot access local variable 'content_str' where it is not associated with a value
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 326, in mock_invoke
    if isinstance(content_str, str):
                  ^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'content_str' where it is not associated with a value
2025-10-26 21:54:25 - agents.nodes.generate_routine - INFO - Attempt 3/3 to generate routine...
2025-10-26 21:54:25 - agents.nodes.generate_routine - ERROR - Attempt 3 failed with unexpected error: cannot access local variable 'content_str' where it is not associated with a value
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 326, in mock_invoke
    if isinstance(content_str, str):
                  ^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'content_str' where it is not associated with a value
2025-10-26 21:54:26 - agents.nodes.generate_routine - ERROR - Failed to generate valid routine after 3 attempts.
2025-10-26 21:54:27 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 21:54:27 - agents.nodes.generate_routine - ERROR - 'principios_libro' missing in state.
2025-10-26 21:54:27 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 21:54:27 - agents.nodes.generate_routine - INFO - Loading routine assembler prompt from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\routine_assembler.txt
2025-10-26 21:54:27 - agents.nodes.generate_routine - INFO - Routine generation chain built.
2025-10-26 21:54:27 - agents.nodes.generate_routine - INFO - Attempt 1/3 to generate routine...
2025-10-26 21:54:27 - agents.nodes.generate_routine - ERROR - Attempt 1 failed with unexpected error: cannot access local variable 'content_str' where it is not associated with a value
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 326, in mock_invoke
    if isinstance(content_str, str):
                  ^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'content_str' where it is not associated with a value
2025-10-26 21:54:28 - agents.nodes.generate_routine - INFO - Attempt 2/3 to generate routine...
2025-10-26 21:54:28 - agents.nodes.generate_routine - ERROR - Attempt 2 failed with unexpected error: cannot access local variable 'content_str' where it is not associated with a value
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 326, in mock_invoke
    if isinstance(content_str, str):
                  ^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'content_str' where it is not associated with a value
2025-10-26 21:54:29 - agents.nodes.generate_routine - INFO - Attempt 3/3 to generate routine...
2025-10-26 21:54:29 - agents.nodes.generate_routine - ERROR - Attempt 3 failed with unexpected error: cannot access local variable 'content_str' where it is not associated with a value
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 326, in mock_invoke
    if isinstance(content_str, str):
                  ^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'content_str' where it is not associated with a value
2025-10-26 21:54:30 - agents.nodes.generate_routine - ERROR - Failed to generate valid routine after 3 attempts.
2025-10-26 21:56:44 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 21:56:44 - agents.nodes.generate_routine - INFO - Loading routine assembler prompt from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\routine_assembler.txt
2025-10-26 21:56:46 - agents.nodes.generate_routine - INFO - Routine generation chain built.
2025-10-26 21:56:46 - agents.nodes.generate_routine - INFO - Attempt 1/3 to generate routine...
2025-10-26 21:56:46 - agents.nodes.generate_routine - INFO - LLM invocation successful.
2025-10-26 21:56:46 - agents.nodes.generate_routine - INFO - Successfully generated and validated routine in 1.38 seconds.
2025-10-26 21:56:46 - agents.nodes.generate_routine - INFO - --- Exiting Generate Routine Node ---
2025-10-26 21:56:46 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 21:56:46 - agents.nodes.generate_routine - ERROR - 'principios_libro' missing in state.
2025-10-26 21:56:46 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 21:56:46 - agents.nodes.generate_routine - INFO - Loading routine assembler prompt from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\routine_assembler.txt
2025-10-26 21:56:46 - agents.nodes.generate_routine - INFO - Routine generation chain built.
2025-10-26 21:56:46 - agents.nodes.generate_routine - INFO - Attempt 1/3 to generate routine...
2025-10-26 21:56:46 - agents.nodes.generate_routine - INFO - LLM invocation successful.
2025-10-26 21:56:46 - agents.nodes.generate_routine - INFO - Successfully generated and validated routine in 0.01 seconds.
2025-10-26 21:56:46 - agents.nodes.generate_routine - INFO - --- Exiting Generate Routine Node ---
2025-10-26 22:00:00 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 22:00:00 - agents.nodes.generate_routine - INFO - Loading routine assembler prompt from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\routine_assembler.txt
2025-10-26 22:00:01 - agents.nodes.generate_routine - INFO - Routine generation chain built.
2025-10-26 22:00:01 - agents.nodes.generate_routine - INFO - Attempt 1/3 to generate routine...
2025-10-26 22:00:01 - agents.nodes.generate_routine - INFO - LLM invocation successful.
2025-10-26 22:00:01 - agents.nodes.generate_routine - INFO - Successfully generated and validated routine in 1.52 seconds.
2025-10-26 22:00:01 - agents.nodes.generate_routine - INFO - --- Exiting Generate Routine Node ---
2025-10-26 22:00:02 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 22:00:02 - agents.nodes.generate_routine - ERROR - 'principios_libro' missing in state.
2025-10-26 22:00:02 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 22:00:02 - agents.nodes.generate_routine - INFO - Loading routine assembler prompt from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\routine_assembler.txt
2025-10-26 22:00:02 - agents.nodes.generate_routine - INFO - Routine generation chain built.
2025-10-26 22:00:02 - agents.nodes.generate_routine - INFO - Attempt 1/3 to generate routine...
2025-10-26 22:00:02 - agents.nodes.generate_routine - ERROR - Attempt 1 failed with unexpected error: LLM Error simulado
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 345, in mock_invoke
    raise error
Exception: LLM Error simulado
2025-10-26 22:00:03 - agents.nodes.generate_routine - INFO - Attempt 2/3 to generate routine...
2025-10-26 22:00:03 - agents.nodes.generate_routine - INFO - LLM invocation successful.
2025-10-26 22:00:03 - agents.nodes.generate_routine - INFO - Successfully generated and validated routine in 1.01 seconds.
2025-10-26 22:00:03 - agents.nodes.generate_routine - INFO - --- Exiting Generate Routine Node ---
2025-10-26 22:02:40 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 22:02:40 - agents.nodes.generate_routine - INFO - Loading routine assembler prompt from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\routine_assembler.txt
2025-10-26 22:02:41 - agents.nodes.generate_routine - INFO - Routine generation chain built.
2025-10-26 22:02:41 - agents.nodes.generate_routine - INFO - Attempt 1/3 to generate routine...
2025-10-26 22:02:41 - agents.nodes.generate_routine - ERROR - Attempt 1 failed with unexpected error: LLM Error simulado
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 345, in mock_invoke
    raise error
Exception: LLM Error simulado
2025-10-26 22:02:42 - agents.nodes.generate_routine - INFO - Attempt 2/3 to generate routine...
2025-10-26 22:02:42 - agents.nodes.generate_routine - INFO - LLM invocation successful.
2025-10-26 22:02:42 - agents.nodes.generate_routine - INFO - Successfully generated and validated routine in 2.26 seconds.
2025-10-26 22:02:42 - agents.nodes.generate_routine - INFO - --- Exiting Generate Routine Node ---
2025-10-26 22:06:10 - agents.nodes.load_context - INFO - --- Entering Load Context Node ---
2025-10-26 22:06:10 - agents.nodes.load_context - INFO - Attempting to load user profile from: C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-4\test_carga_perfil_usuario_exit0\users\test_user.json
2025-10-26 22:06:10 - agents.nodes.load_context - INFO - Successfully loaded profile for user: test_user
2025-10-26 22:06:10 - agents.nodes.load_context - INFO - --- Exiting Load Context Node ---
2025-10-26 22:06:10 - agents.nodes.load_context - INFO - --- Entering Load Context Node ---
2025-10-26 22:06:10 - agents.nodes.load_context - INFO - Attempting to load user profile from: C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-4\test_maneja_usuario_no_encontr0\users\usuario_inexistente.json
2025-10-26 22:06:10 - agents.nodes.load_context - ERROR - User file not found for user_id: usuario_inexistente at C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-4\test_maneja_usuario_no_encontr0\users\usuario_inexistente.json
2025-10-26 22:06:10 - agents.nodes.load_context - INFO - --- Entering Load Context Node ---
2025-10-26 22:06:10 - agents.nodes.load_context - INFO - Attempting to load user profile from: C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-4\test_maneja_json_corrupto0\users\corrupt_user.json
2025-10-26 22:06:10 - agents.nodes.load_context - ERROR - Failed to decode JSON for user corrupt_user: Expecting property name enclosed in double quotes: line 1 column 48 (char 47)
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\load_context.py", line 45, in load_context
    user_profile = json.load(f)
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python313\Lib\json\__init__.py", line 293, in load
    return loads(fp.read(),
        cls=cls, object_hook=object_hook,
        parse_float=parse_float, parse_int=parse_int,
        parse_constant=parse_constant, object_pairs_hook=object_pairs_hook, **kw)
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python313\Lib\json\__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python313\Lib\json\decoder.py", line 345, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python313\Lib\json\decoder.py", line 361, in raw_decode
    obj, end = self.scan_once(s, idx)
               ~~~~~~~~~~~~~~^^^^^^^^
json.decoder.JSONDecodeError: Expecting property name enclosed in double quotes: line 1 column 48 (char 47)
2025-10-26 22:06:10 - agents.nodes.load_context - INFO - --- Exiting Load Context Node ---
2025-10-26 22:06:10 - agents.nodes.load_context - INFO - --- Entering Load Context Node ---
2025-10-26 22:06:10 - agents.nodes.load_context - INFO - Attempting to load user profile from: C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-4\test_maneja_perfil_incompleto0\users\incomplete_user.json
2025-10-26 22:06:10 - agents.nodes.load_context - ERROR - User profile for incomplete_user is incomplete. Missing fields: ['level', 'objetivo']
2025-10-26 22:06:10 - agents.nodes.extract_principles - INFO - --- Entering Extract Principles Node ---
2025-10-26 22:06:10 - agents.nodes.extract_principles - INFO - Initializing PrincipleExtractor...
2025-10-26 22:06:12 - rag.principle_extractor - INFO - PrincipleExtractor initialized.
2025-10-26 22:06:12 - agents.nodes.extract_principles - INFO - Extraction chain obtained. Invoking...
2025-10-26 22:06:12 - agents.nodes.extract_principles - INFO - Successfully extracted principles for user: test_user
2025-10-26 22:06:12 - agents.nodes.extract_principles - INFO - --- Exiting Extract Principles Node ---
2025-10-26 22:06:12 - agents.nodes.extract_principles - INFO - --- Entering Extract Principles Node ---
2025-10-26 22:06:12 - agents.nodes.extract_principles - INFO - Initializing PrincipleExtractor...
2025-10-26 22:06:13 - rag.principle_extractor - INFO - PrincipleExtractor initialized.
2025-10-26 22:06:13 - agents.nodes.extract_principles - INFO - Extraction chain obtained. Invoking...
2025-10-26 22:06:13 - agents.nodes.extract_principles - ERROR - CRITICAL: Extracted principles lack source citations!
2025-10-26 22:06:13 - agents.nodes.extract_principles - ERROR - Error invoking principle extraction chain: 'NoneType' object does not support item assignment
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\extract_principles.py", line 63, in extract_principles
    state["debug_info"]["principles_without_citations"] = principios.model_dump() # Pydantic V2
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: 'NoneType' object does not support item assignment
2025-10-26 22:06:13 - agents.nodes.extract_principles - INFO - --- Exiting Extract Principles Node ---
2025-10-26 22:06:13 - agents.nodes.extract_principles - INFO - --- Entering Extract Principles Node ---
2025-10-26 22:06:13 - agents.nodes.extract_principles - INFO - Initializing PrincipleExtractor...
2025-10-26 22:06:13 - rag.principle_extractor - INFO - PrincipleExtractor initialized.
2025-10-26 22:06:13 - agents.nodes.extract_principles - INFO - Extraction chain obtained. Invoking...
2025-10-26 22:06:13 - agents.nodes.extract_principles - INFO - Successfully extracted principles for user: test_user
2025-10-26 22:06:13 - agents.nodes.extract_principles - INFO - --- Exiting Extract Principles Node ---
2025-10-26 22:06:13 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 22:06:13 - agents.nodes.generate_routine - INFO - Loading routine assembler prompt from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\routine_assembler.txt
2025-10-26 22:06:13 - agents.nodes.generate_routine - INFO - Routine generation chain built.
2025-10-26 22:06:13 - agents.nodes.generate_routine - INFO - Attempt 1/3 to generate routine...
2025-10-26 22:06:13 - agents.nodes.generate_routine - INFO - LLM invocation successful.
2025-10-26 22:06:13 - agents.nodes.generate_routine - INFO - Successfully generated and validated routine in 0.01 seconds.
2025-10-26 22:06:13 - agents.nodes.generate_routine - INFO - --- Exiting Generate Routine Node ---
2025-10-26 22:06:13 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 22:06:13 - agents.nodes.generate_routine - ERROR - 'principios_libro' missing in state.
2025-10-26 22:06:13 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 22:06:13 - agents.nodes.generate_routine - INFO - Loading routine assembler prompt from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\routine_assembler.txt
2025-10-26 22:06:13 - agents.nodes.generate_routine - INFO - Routine generation chain built.
2025-10-26 22:06:13 - agents.nodes.generate_routine - INFO - Attempt 1/3 to generate routine...
2025-10-26 22:06:13 - agents.nodes.generate_routine - ERROR - Attempt 1 failed with unexpected error: LLM Error simulado
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 345, in mock_invoke
    raise error
Exception: LLM Error simulado
2025-10-26 22:06:14 - agents.nodes.generate_routine - INFO - Attempt 2/3 to generate routine...
2025-10-26 22:06:14 - agents.nodes.generate_routine - INFO - LLM invocation successful.
2025-10-26 22:06:14 - agents.nodes.generate_routine - INFO - Successfully generated and validated routine in 1.01 seconds.
2025-10-26 22:06:14 - agents.nodes.generate_routine - INFO - --- Exiting Generate Routine Node ---
2025-10-26 22:06:14 - agents.nodes.save_routine - INFO - --- Entering Save Routine Node ---
2025-10-26 22:06:14 - agents.nodes.save_routine - INFO - Attempting to save routine for user test_user to C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-4\test_guarda_rutina_exitosament0\users\test_user.json
2025-10-26 22:06:14 - agents.nodes.save_routine - INFO - Created backup at: C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-4\test_guarda_rutina_exitosament0\users\test_user.20251026220614.backup
2025-10-26 22:06:14 - agents.nodes.save_routine - INFO - Successfully wrote updated data to C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-4\test_guarda_rutina_exitosament0\users\test_user.json
2025-10-26 22:06:14 - agents.nodes.save_routine - INFO - Post-write verification passed.
2025-10-26 22:06:14 - agents.nodes.save_routine - INFO - --- Exiting Save Routine Node ---
2025-10-26 22:06:14 - agents.nodes.save_routine - INFO - --- Entering Save Routine Node ---
2025-10-26 22:06:14 - agents.nodes.save_routine - ERROR - 'rutina_final' missing or None in state.
2025-10-26 22:06:14 - agents.nodes.save_routine - INFO - --- Entering Save Routine Node ---
2025-10-26 22:06:14 - agents.nodes.save_routine - INFO - Attempting to save routine for user test_user to C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-4\test_maneja_error_io0\users\test_user.json
2025-10-26 22:06:14 - agents.nodes.save_routine - ERROR - File system error saving routine for test_user: Error de permisos simulado
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\save_routine.py", line 62, in save_routine
    with open(user_file_path, "r", encoding="utf-8") as f:
         ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python313\Lib\unittest\mock.py", line 1169, in __call__
    return self._mock_call(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python313\Lib\unittest\mock.py", line 1173, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python313\Lib\unittest\mock.py", line 1228, in _execute_mock_call
    raise effect
OSError: Error de permisos simulado
2025-10-26 22:06:14 - agents.nodes.save_routine - INFO - --- Exiting Save Routine Node ---
2025-10-26 22:06:14 - agents.nodes.handle_error - INFO - --- Entering Handle Error Node ---
2025-10-26 22:06:14 - agents.nodes.handle_error - ERROR - Error captured in step 'paso_anterior_fallo': Usuario 'xyz' no encontrado
2025-10-26 22:06:14 - agents.nodes.handle_error - INFO - Generated user-friendly error message:  Lo siento, hubo un problema: Ocurri un error inesperado procesando tu solicitud.
(Referencia: paso 'paso_anterior_fallo')
2025-10-26 22:06:14 - agents.nodes.handle_error - INFO - --- Exiting Handle Error Node ---
2025-10-26 22:06:14 - agents.nodes.handle_error - INFO - --- Entering Handle Error Node ---
2025-10-26 22:06:14 - agents.nodes.handle_error - ERROR - Error captured in step 'paso_anterior_fallo': Archivo corrupto para usuario 'abc': Unterminated string
2025-10-26 22:06:14 - agents.nodes.handle_error - INFO - Generated user-friendly error message:  Lo siento, hubo un problema: Hubo un problema al leer los datos de tu perfil. Podra estar corrupto.
(Referencia: paso 'paso_anterior_fallo')
2025-10-26 22:06:14 - agents.nodes.handle_error - INFO - --- Exiting Handle Error Node ---
2025-10-26 22:06:14 - agents.nodes.handle_error - INFO - --- Entering Handle Error Node ---
2025-10-26 22:06:14 - agents.nodes.handle_error - ERROR - Error captured in step 'paso_anterior_fallo': Alucinacin detectada: principios extrados sin citas
2025-10-26 22:06:14 - agents.nodes.handle_error - INFO - Generated user-friendly error message:  Lo siento, hubo un problema: No pude verificar la informacin extrada del libro (faltan citas). No puedo proceder de forma segura.
(Referencia: paso 'paso_anterior_fallo')
2025-10-26 22:06:14 - agents.nodes.handle_error - INFO - --- Exiting Handle Error Node ---
2025-10-26 22:06:14 - agents.nodes.handle_error - INFO - --- Entering Handle Error Node ---
2025-10-26 22:06:14 - agents.nodes.handle_error - ERROR - Error captured in step 'paso_anterior_fallo': Validacin fallida: RIR inconsistente
2025-10-26 22:06:14 - agents.nodes.handle_error - INFO - Generated user-friendly error message:  Lo siento, hubo un problema: La rutina generada no parece cumplir con los principios o tus preferencias.
(Referencia: paso 'paso_anterior_fallo')
2025-10-26 22:06:14 - agents.nodes.handle_error - INFO - --- Exiting Handle Error Node ---
2025-10-26 22:06:14 - agents.nodes.handle_error - INFO - --- Entering Handle Error Node ---
2025-10-26 22:06:14 - agents.nodes.handle_error - ERROR - Error captured in step 'paso_anterior_fallo': Error de archivo guardando rutina: [Errno 13] Permission denied
2025-10-26 22:06:14 - agents.nodes.handle_error - INFO - Generated user-friendly error message:  Lo siento, hubo un problema: Hubo un problema al intentar guardar la rutina en tu perfil.
(Referencia: paso 'paso_anterior_fallo')
2025-10-26 22:06:14 - agents.nodes.handle_error - INFO - --- Exiting Handle Error Node ---
2025-10-26 22:06:14 - agents.nodes.handle_error - INFO - --- Entering Handle Error Node ---
2025-10-26 22:06:14 - agents.nodes.handle_error - ERROR - Error captured in step 'paso_anterior_fallo': Error desconocido criptogrfico
2025-10-26 22:06:14 - agents.nodes.handle_error - INFO - Generated user-friendly error message:  Lo siento, hubo un problema: Ocurri un error inesperado procesando tu solicitud.
(Referencia: paso 'paso_anterior_fallo')
2025-10-26 22:06:14 - agents.nodes.handle_error - INFO - --- Exiting Handle Error Node ---
2025-10-26 22:06:14 - agents.nodes.load_context - INFO - --- Entering Load Context Node ---
2025-10-26 22:06:14 - agents.nodes.load_context - INFO - Attempting to load user profile from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\data\users\test_user.json
2025-10-26 22:06:14 - agents.nodes.load_context - ERROR - User file not found for user_id: test_user at C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\data\users\test_user.json
2025-10-26 22:06:14 - agents.nodes.handle_error - INFO - --- Entering Handle Error Node ---
2025-10-26 22:06:14 - agents.nodes.handle_error - ERROR - Error captured in step '': Error simulado para prueba de handle_error
2025-10-26 22:06:14 - agents.nodes.handle_error - INFO - Generated user-friendly error message:  Lo siento, hubo un problema: Ocurri un error inesperado procesando tu solicitud.
(Referencia: paso '')
2025-10-26 22:06:14 - agents.nodes.handle_error - INFO - --- Exiting Handle Error Node ---
2025-10-26 22:06:15 - rag.vectorstore_manager - INFO - Loading existing vector store from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\data\chroma_db
2025-10-26 22:06:17 - rag.vectorstore_manager - INFO -  Vector store loaded successfully.
2025-10-26 22:06:21 - rag.principle_extractor - INFO - PrincipleExtractor initialized.
2025-10-26 22:06:21 - rag.principle_extractor - INFO - Building the principle extraction RAG chain...
2025-10-26 22:06:21 - rag.principle_extractor - INFO - Loading prompt template from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\rag_principle_extractor.txt
2025-10-26 22:06:21 - rag.principle_extractor - INFO - Prompt template loaded successfully.
2025-10-26 22:06:21 - rag.vectorstore_manager - INFO - Loading existing vector store from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\data\chroma_db
2025-10-26 22:06:21 - rag.vectorstore_manager - INFO -  Vector store loaded successfully.
2025-10-26 22:06:21 - rag.principle_extractor - INFO - Retriever obtained from vector store.
2025-10-26 22:06:21 - rag.principle_extractor - INFO - PromptTemplate instance created.
2025-10-26 22:06:21 - rag.principle_extractor - INFO -  Principle extraction RAG chain built successfully.
2025-10-26 22:06:22 - rag.principle_extractor - INFO - PrincipleExtractor initialized.
2025-10-26 22:06:22 - rag.principle_extractor - INFO - Building the principle extraction RAG chain...
2025-10-26 22:06:22 - rag.principle_extractor - INFO - Loading prompt template from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\rag_principle_extractor.txt
2025-10-26 22:06:22 - rag.principle_extractor - INFO - Prompt template loaded successfully.
2025-10-26 22:06:22 - rag.vectorstore_manager - INFO - Loading existing vector store from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\data\chroma_db
2025-10-26 22:06:22 - rag.vectorstore_manager - INFO -  Vector store loaded successfully.
2025-10-26 22:06:22 - rag.principle_extractor - INFO - Retriever obtained from vector store.
2025-10-26 22:06:22 - rag.principle_extractor - INFO - PromptTemplate instance created.
2025-10-26 22:06:22 - rag.principle_extractor - INFO -  Principle extraction RAG chain built successfully.
2025-10-26 22:06:23 - rag.principle_extractor - INFO - PrincipleExtractor initialized.
2025-10-26 22:06:23 - rag.principle_extractor - INFO - Building the principle extraction RAG chain...
2025-10-26 22:06:23 - rag.principle_extractor - INFO - Loading prompt template from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\rag_principle_extractor.txt
2025-10-26 22:06:23 - rag.principle_extractor - INFO - Prompt template loaded successfully.
2025-10-26 22:06:23 - rag.vectorstore_manager - INFO - Loading existing vector store from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\data\chroma_db
2025-10-26 22:06:23 - rag.vectorstore_manager - INFO -  Vector store loaded successfully.
2025-10-26 22:06:23 - rag.principle_extractor - INFO - Retriever obtained from vector store.
2025-10-26 22:06:23 - rag.principle_extractor - INFO - PromptTemplate instance created.
2025-10-26 22:06:23 - rag.principle_extractor - INFO -  Principle extraction RAG chain built successfully.
2025-10-26 22:06:24 - rag.principle_extractor - INFO - PrincipleExtractor initialized.
2025-10-26 22:06:24 - rag.principle_extractor - INFO - Building the principle extraction RAG chain...
2025-10-26 22:06:24 - rag.principle_extractor - INFO - Loading prompt template from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\rag_principle_extractor.txt
2025-10-26 22:06:24 - rag.principle_extractor - INFO - Prompt template loaded successfully.
2025-10-26 22:06:24 - rag.vectorstore_manager - INFO - Loading existing vector store from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\data\chroma_db
2025-10-26 22:06:24 - rag.vectorstore_manager - INFO -  Vector store loaded successfully.
2025-10-26 22:06:24 - rag.principle_extractor - INFO - Retriever obtained from vector store.
2025-10-26 22:06:24 - rag.principle_extractor - INFO - PromptTemplate instance created.
2025-10-26 22:06:24 - rag.principle_extractor - INFO -  Principle extraction RAG chain built successfully.
2025-10-26 22:06:25 - rag.principle_extractor - INFO - PrincipleExtractor initialized.
2025-10-26 22:06:25 - rag.principle_extractor - INFO - Building the principle extraction RAG chain...
2025-10-26 22:06:25 - rag.principle_extractor - INFO - Loading prompt template from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\rag_principle_extractor.txt
2025-10-26 22:06:25 - rag.principle_extractor - INFO - Prompt template loaded successfully.
2025-10-26 22:06:25 - rag.vectorstore_manager - INFO - Loading existing vector store from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\data\chroma_db
2025-10-26 22:06:25 - rag.vectorstore_manager - INFO -  Vector store loaded successfully.
2025-10-26 22:06:25 - rag.principle_extractor - INFO - Retriever obtained from vector store.
2025-10-26 22:06:25 - rag.principle_extractor - INFO - PromptTemplate instance created.
2025-10-26 22:06:25 - rag.principle_extractor - INFO -  Principle extraction RAG chain built successfully.
2025-10-26 22:12:02 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 22:12:02 - agents.nodes.generate_routine - INFO - Loading routine assembler prompt from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\routine_assembler.txt
2025-10-26 22:12:03 - agents.nodes.generate_routine - INFO - Routine generation chain built.
2025-10-26 22:12:03 - agents.nodes.generate_routine - INFO - Attempt 1/3 to generate routine...
2025-10-26 22:12:03 - agents.nodes.generate_routine - ERROR - Attempt 1 failed with unexpected error: LLM Error simulado
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 345, in mock_invoke
    raise error
Exception: LLM Error simulado
2025-10-26 22:12:04 - agents.nodes.generate_routine - INFO - Attempt 2/3 to generate routine...
2025-10-26 22:12:04 - agents.nodes.generate_routine - INFO - LLM invocation successful.
2025-10-26 22:12:04 - agents.nodes.generate_routine - INFO - Successfully generated and validated routine in 2.37 seconds.
2025-10-26 22:12:04 - agents.nodes.generate_routine - INFO - --- Exiting Generate Routine Node ---
2025-10-26 22:12:53 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 22:12:53 - agents.nodes.generate_routine - INFO - Loading routine assembler prompt from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\routine_assembler.txt
2025-10-26 22:12:54 - agents.nodes.generate_routine - INFO - Routine generation chain built.
2025-10-26 22:12:54 - agents.nodes.generate_routine - INFO - Attempt 1/3 to generate routine...
2025-10-26 22:12:54 - agents.nodes.generate_routine - INFO - LLM invocation successful.
2025-10-26 22:12:54 - agents.nodes.generate_routine - INFO - Successfully generated and validated routine in 1.21 seconds.
2025-10-26 22:12:54 - agents.nodes.generate_routine - INFO - --- Exiting Generate Routine Node ---
2025-10-26 22:12:54 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 22:12:54 - agents.nodes.generate_routine - ERROR - 'principios_libro' missing in state.
2025-10-26 22:12:54 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 22:12:54 - agents.nodes.generate_routine - INFO - Loading routine assembler prompt from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\routine_assembler.txt
2025-10-26 22:12:54 - agents.nodes.generate_routine - INFO - Routine generation chain built.
2025-10-26 22:12:54 - agents.nodes.generate_routine - INFO - Attempt 1/3 to generate routine...
2025-10-26 22:12:54 - agents.nodes.generate_routine - ERROR - Attempt 1 failed with unexpected error: LLM Error simulado
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 345, in mock_invoke
    raise error
Exception: LLM Error simulado
2025-10-26 22:12:55 - agents.nodes.generate_routine - INFO - Attempt 2/3 to generate routine...
2025-10-26 22:12:55 - agents.nodes.generate_routine - INFO - LLM invocation successful.
2025-10-26 22:12:55 - agents.nodes.generate_routine - INFO - Successfully generated and validated routine in 1.01 seconds.
2025-10-26 22:12:55 - agents.nodes.generate_routine - INFO - --- Exiting Generate Routine Node ---
2025-10-26 22:18:19 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 22:18:19 - agents.nodes.generate_routine - INFO - Loading routine assembler prompt from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\routine_assembler.txt
2025-10-26 22:18:20 - agents.nodes.generate_routine - INFO - Routine generation chain built.
2025-10-26 22:18:20 - agents.nodes.generate_routine - INFO - Attempt 1/3 to generate routine...
2025-10-26 22:18:20 - agents.nodes.generate_routine - ERROR - Attempt 1 failed with unexpected error: LLM Error simulado
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 345, in mock_invoke
    raise error
Exception: LLM Error simulado
2025-10-26 22:18:21 - agents.nodes.generate_routine - INFO - Attempt 2/3 to generate routine...
2025-10-26 22:18:21 - agents.nodes.generate_routine - ERROR - Attempt 2 failed with unexpected error: LLM Error simulado
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 345, in mock_invoke
    raise error
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 345, in mock_invoke
    raise error
Exception: LLM Error simulado
2025-10-26 22:18:22 - agents.nodes.generate_routine - INFO - Attempt 3/3 to generate routine...
2025-10-26 22:18:22 - agents.nodes.generate_routine - ERROR - Attempt 3 failed with unexpected error: LLM Error simulado
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 345, in mock_invoke
    raise error
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 345, in mock_invoke
    raise error
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 345, in mock_invoke
    raise error
Exception: LLM Error simulado
2025-10-26 22:18:23 - agents.nodes.generate_routine - ERROR - Failed to generate valid routine after 3 attempts.
2025-10-26 22:18:32 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 22:18:32 - agents.nodes.generate_routine - INFO - Loading routine assembler prompt from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\routine_assembler.txt
2025-10-26 22:18:33 - agents.nodes.generate_routine - INFO - Routine generation chain built.
2025-10-26 22:18:33 - agents.nodes.generate_routine - INFO - Attempt 1/3 to generate routine...
2025-10-26 22:18:33 - agents.nodes.generate_routine - INFO - LLM invocation successful.
2025-10-26 22:18:33 - agents.nodes.generate_routine - INFO - Successfully generated and validated routine in 1.27 seconds.
2025-10-26 22:18:33 - agents.nodes.generate_routine - INFO - --- Exiting Generate Routine Node ---
2025-10-26 22:18:33 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 22:18:33 - agents.nodes.generate_routine - ERROR - 'principios_libro' missing in state.
2025-10-26 22:18:33 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 22:18:33 - agents.nodes.generate_routine - INFO - Loading routine assembler prompt from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\routine_assembler.txt
2025-10-26 22:18:33 - agents.nodes.generate_routine - INFO - Routine generation chain built.
2025-10-26 22:18:33 - agents.nodes.generate_routine - INFO - Attempt 1/3 to generate routine...
2025-10-26 22:18:33 - agents.nodes.generate_routine - ERROR - Attempt 1 failed with unexpected error: LLM Error simulado
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 345, in mock_invoke
    raise error
Exception: LLM Error simulado
2025-10-26 22:18:34 - agents.nodes.generate_routine - INFO - Attempt 2/3 to generate routine...
2025-10-26 22:18:34 - agents.nodes.generate_routine - ERROR - Attempt 2 failed with unexpected error: LLM Error simulado
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 345, in mock_invoke
    raise error
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 345, in mock_invoke
    raise error
Exception: LLM Error simulado
2025-10-26 22:18:35 - agents.nodes.generate_routine - INFO - Attempt 3/3 to generate routine...
2025-10-26 22:18:35 - agents.nodes.generate_routine - ERROR - Attempt 3 failed with unexpected error: LLM Error simulado
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 345, in mock_invoke
    raise error
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 345, in mock_invoke
    raise error
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 345, in mock_invoke
    raise error
Exception: LLM Error simulado
2025-10-26 22:18:36 - agents.nodes.generate_routine - ERROR - Failed to generate valid routine after 3 attempts.
2025-10-26 22:24:20 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 22:24:20 - agents.nodes.generate_routine - INFO - Loading routine assembler prompt from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\routine_assembler.txt
2025-10-26 22:24:21 - agents.nodes.generate_routine - INFO - Routine generation chain built.
2025-10-26 22:24:21 - agents.nodes.generate_routine - INFO - Attempt 1/3 to generate routine...
2025-10-26 22:24:21 - agents.nodes.generate_routine - INFO - LLM invocation successful.
2025-10-26 22:24:21 - agents.nodes.generate_routine - INFO - Successfully generated and validated routine in 1.41 seconds.
2025-10-26 22:24:21 - agents.nodes.generate_routine - INFO - --- Exiting Generate Routine Node ---
2025-10-26 22:24:21 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 22:24:21 - agents.nodes.generate_routine - ERROR - 'principios_libro' missing in state.
2025-10-26 22:24:21 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 22:24:21 - agents.nodes.generate_routine - INFO - Loading routine assembler prompt from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\routine_assembler.txt
2025-10-26 22:24:21 - agents.nodes.generate_routine - INFO - Routine generation chain built.
2025-10-26 22:24:21 - agents.nodes.generate_routine - INFO - Attempt 1/3 to generate routine...
2025-10-26 22:24:21 - agents.nodes.generate_routine - ERROR - Attempt 1 failed with unexpected error: LLM Error simulado
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
Exception: LLM Error simulado
2025-10-26 22:24:22 - agents.nodes.generate_routine - INFO - Attempt 2/3 to generate routine...
2025-10-26 22:24:22 - agents.nodes.generate_routine - ERROR - Attempt 2 failed with unexpected error: LLM Error simulado
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
Exception: LLM Error simulado
2025-10-26 22:24:23 - agents.nodes.generate_routine - INFO - Attempt 3/3 to generate routine...
2025-10-26 22:24:23 - agents.nodes.generate_routine - ERROR - Attempt 3 failed with unexpected error: LLM Error simulado
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
Exception: LLM Error simulado
2025-10-26 22:24:24 - agents.nodes.generate_routine - ERROR - Failed to generate valid routine after 3 attempts.
2025-10-26 22:25:19 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 22:25:19 - agents.nodes.generate_routine - INFO - Loading routine assembler prompt from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\routine_assembler.txt
2025-10-26 22:25:21 - agents.nodes.generate_routine - INFO - Routine generation chain built.
2025-10-26 22:25:21 - agents.nodes.generate_routine - INFO - Attempt 1/3 to generate routine...
2025-10-26 22:25:21 - agents.nodes.generate_routine - ERROR - Attempt 1 failed with unexpected error: LLM Error simulado
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
Exception: LLM Error simulado
2025-10-26 22:25:22 - agents.nodes.generate_routine - INFO - Attempt 2/3 to generate routine...
2025-10-26 22:25:22 - agents.nodes.generate_routine - ERROR - Attempt 2 failed with unexpected error: LLM Error simulado
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
Exception: LLM Error simulado
2025-10-26 22:25:23 - agents.nodes.generate_routine - INFO - Attempt 3/3 to generate routine...
2025-10-26 22:25:23 - agents.nodes.generate_routine - ERROR - Attempt 3 failed with unexpected error: LLM Error simulado
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
Exception: LLM Error simulado
2025-10-26 22:25:24 - agents.nodes.generate_routine - ERROR - Failed to generate valid routine after 3 attempts.
2025-10-26 22:28:05 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 22:28:05 - agents.nodes.generate_routine - INFO - Loading routine assembler prompt from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\routine_assembler.txt
2025-10-26 22:28:06 - agents.nodes.generate_routine - INFO - Routine generation chain built.
2025-10-26 22:28:06 - agents.nodes.generate_routine - INFO - Attempt 1/3 to generate routine...
2025-10-26 22:28:06 - agents.nodes.generate_routine - ERROR - Attempt 1 failed with unexpected error: LLM Error simulado
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
Exception: LLM Error simulado
2025-10-26 22:28:07 - agents.nodes.generate_routine - INFO - Attempt 2/3 to generate routine...
2025-10-26 22:28:07 - agents.nodes.generate_routine - ERROR - Attempt 2 failed with unexpected error: LLM Error simulado
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
Exception: LLM Error simulado
2025-10-26 22:28:08 - agents.nodes.generate_routine - INFO - Attempt 3/3 to generate routine...
2025-10-26 22:28:08 - agents.nodes.generate_routine - ERROR - Attempt 3 failed with unexpected error: LLM Error simulado
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
Exception: LLM Error simulado
2025-10-26 22:28:09 - agents.nodes.generate_routine - ERROR - Failed to generate valid routine after 3 attempts.
2025-10-26 22:33:45 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 22:33:45 - agents.nodes.generate_routine - INFO - Loading routine assembler prompt from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\routine_assembler.txt
2025-10-26 22:33:46 - agents.nodes.generate_routine - INFO - Routine generation chain built.
2025-10-26 22:33:46 - agents.nodes.generate_routine - INFO - Attempt 1/3 to generate routine...
2025-10-26 22:33:46 - agents.nodes.generate_routine - ERROR - Attempt 1 failed with unexpected error: LLM Error simulado
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
Exception: LLM Error simulado
2025-10-26 22:33:47 - agents.nodes.generate_routine - INFO - Attempt 2/3 to generate routine...
2025-10-26 22:33:47 - agents.nodes.generate_routine - ERROR - Attempt 2 failed with unexpected error: LLM Error simulado
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
Exception: LLM Error simulado
2025-10-26 22:33:48 - agents.nodes.generate_routine - INFO - Attempt 3/3 to generate routine...
2025-10-26 22:33:48 - agents.nodes.generate_routine - ERROR - Attempt 3 failed with unexpected error: LLM Error simulado
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
Exception: LLM Error simulado
2025-10-26 22:33:49 - agents.nodes.generate_routine - ERROR - Failed to generate valid routine after 3 attempts.
2025-10-26 22:34:18 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 22:34:18 - agents.nodes.generate_routine - INFO - Loading routine assembler prompt from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\routine_assembler.txt
2025-10-26 22:34:19 - agents.nodes.generate_routine - INFO - Routine generation chain built.
2025-10-26 22:34:19 - agents.nodes.generate_routine - INFO - Attempt 1/3 to generate routine...
2025-10-26 22:34:19 - agents.nodes.generate_routine - INFO - LLM invocation successful.
2025-10-26 22:34:19 - agents.nodes.generate_routine - INFO - Successfully generated and validated routine in 1.26 seconds.
2025-10-26 22:34:19 - agents.nodes.generate_routine - INFO - --- Exiting Generate Routine Node ---
2025-10-26 22:34:19 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 22:34:19 - agents.nodes.generate_routine - ERROR - 'principios_libro' missing in state.
2025-10-26 22:34:19 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 22:34:19 - agents.nodes.generate_routine - INFO - Loading routine assembler prompt from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\routine_assembler.txt
2025-10-26 22:34:19 - agents.nodes.generate_routine - INFO - Routine generation chain built.
2025-10-26 22:34:19 - agents.nodes.generate_routine - INFO - Attempt 1/3 to generate routine...
2025-10-26 22:34:19 - agents.nodes.generate_routine - ERROR - Attempt 1 failed with unexpected error: LLM Error simulado
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
Exception: LLM Error simulado
2025-10-26 22:34:20 - agents.nodes.generate_routine - INFO - Attempt 2/3 to generate routine...
2025-10-26 22:34:20 - agents.nodes.generate_routine - ERROR - Attempt 2 failed with unexpected error: LLM Error simulado
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
Exception: LLM Error simulado
2025-10-26 22:34:21 - agents.nodes.generate_routine - INFO - Attempt 3/3 to generate routine...
2025-10-26 22:34:21 - agents.nodes.generate_routine - ERROR - Attempt 3 failed with unexpected error: LLM Error simulado
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "c:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
Exception: LLM Error simulado
2025-10-26 22:34:22 - agents.nodes.generate_routine - ERROR - Failed to generate valid routine after 3 attempts.
2025-10-26 22:34:51 - agents.nodes.load_context - INFO - --- Entering Load Context Node ---
2025-10-26 22:34:51 - agents.nodes.load_context - INFO - Attempting to load user profile from: C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-5\test_carga_perfil_usuario_exit0\users\test_user.json
2025-10-26 22:34:51 - agents.nodes.load_context - INFO - Successfully loaded profile for user: test_user
2025-10-26 22:34:51 - agents.nodes.load_context - INFO - --- Exiting Load Context Node ---
2025-10-26 22:34:51 - agents.nodes.load_context - INFO - --- Entering Load Context Node ---
2025-10-26 22:34:51 - agents.nodes.load_context - INFO - Attempting to load user profile from: C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-5\test_maneja_usuario_no_encontr0\users\usuario_inexistente.json
2025-10-26 22:34:51 - agents.nodes.load_context - ERROR - User file not found for user_id: usuario_inexistente at C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-5\test_maneja_usuario_no_encontr0\users\usuario_inexistente.json
2025-10-26 22:34:51 - agents.nodes.load_context - INFO - --- Entering Load Context Node ---
2025-10-26 22:34:51 - agents.nodes.load_context - INFO - Attempting to load user profile from: C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-5\test_maneja_json_corrupto0\users\corrupt_user.json
2025-10-26 22:34:51 - agents.nodes.load_context - ERROR - Failed to decode JSON for user corrupt_user: Expecting property name enclosed in double quotes: line 1 column 48 (char 47)
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\load_context.py", line 45, in load_context
    user_profile = json.load(f)
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python313\Lib\json\__init__.py", line 293, in load
    return loads(fp.read(),
        cls=cls, object_hook=object_hook,
        parse_float=parse_float, parse_int=parse_int,
        parse_constant=parse_constant, object_pairs_hook=object_pairs_hook, **kw)
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python313\Lib\json\__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python313\Lib\json\decoder.py", line 345, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python313\Lib\json\decoder.py", line 361, in raw_decode
    obj, end = self.scan_once(s, idx)
               ~~~~~~~~~~~~~~^^^^^^^^
json.decoder.JSONDecodeError: Expecting property name enclosed in double quotes: line 1 column 48 (char 47)
2025-10-26 22:34:51 - agents.nodes.load_context - INFO - --- Exiting Load Context Node ---
2025-10-26 22:34:51 - agents.nodes.load_context - INFO - --- Entering Load Context Node ---
2025-10-26 22:34:51 - agents.nodes.load_context - INFO - Attempting to load user profile from: C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-5\test_maneja_perfil_incompleto0\users\incomplete_user.json
2025-10-26 22:34:51 - agents.nodes.load_context - ERROR - User profile for incomplete_user is incomplete. Missing fields: ['level', 'objetivo']
2025-10-26 22:34:51 - agents.nodes.extract_principles - INFO - --- Entering Extract Principles Node ---
2025-10-26 22:34:51 - agents.nodes.extract_principles - INFO - Initializing PrincipleExtractor...
2025-10-26 22:34:53 - rag.principle_extractor - INFO - PrincipleExtractor initialized.
2025-10-26 22:34:53 - agents.nodes.extract_principles - INFO - Extraction chain obtained. Invoking...
2025-10-26 22:34:53 - agents.nodes.extract_principles - INFO - Successfully extracted principles for user: test_user
2025-10-26 22:34:53 - agents.nodes.extract_principles - INFO - --- Exiting Extract Principles Node ---
2025-10-26 22:34:53 - agents.nodes.extract_principles - INFO - --- Entering Extract Principles Node ---
2025-10-26 22:34:53 - agents.nodes.extract_principles - INFO - Initializing PrincipleExtractor...
2025-10-26 22:34:54 - rag.principle_extractor - INFO - PrincipleExtractor initialized.
2025-10-26 22:34:54 - agents.nodes.extract_principles - INFO - Extraction chain obtained. Invoking...
2025-10-26 22:34:54 - agents.nodes.extract_principles - ERROR - CRITICAL: Extracted principles lack source citations!
2025-10-26 22:34:54 - agents.nodes.extract_principles - ERROR - Error invoking principle extraction chain: 'NoneType' object does not support item assignment
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\extract_principles.py", line 63, in extract_principles
    state["debug_info"]["principles_without_citations"] = principios.model_dump() # Pydantic V2
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: 'NoneType' object does not support item assignment
2025-10-26 22:34:54 - agents.nodes.extract_principles - INFO - --- Exiting Extract Principles Node ---
2025-10-26 22:34:54 - agents.nodes.extract_principles - INFO - --- Entering Extract Principles Node ---
2025-10-26 22:34:54 - agents.nodes.extract_principles - INFO - Initializing PrincipleExtractor...
2025-10-26 22:34:55 - rag.principle_extractor - INFO - PrincipleExtractor initialized.
2025-10-26 22:34:55 - agents.nodes.extract_principles - INFO - Extraction chain obtained. Invoking...
2025-10-26 22:34:55 - agents.nodes.extract_principles - INFO - Successfully extracted principles for user: test_user
2025-10-26 22:34:55 - agents.nodes.extract_principles - INFO - --- Exiting Extract Principles Node ---
2025-10-26 22:34:55 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 22:34:55 - agents.nodes.generate_routine - INFO - Loading routine assembler prompt from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\routine_assembler.txt
2025-10-26 22:34:55 - agents.nodes.generate_routine - INFO - Routine generation chain built.
2025-10-26 22:34:55 - agents.nodes.generate_routine - INFO - Attempt 1/3 to generate routine...
2025-10-26 22:34:55 - agents.nodes.generate_routine - INFO - LLM invocation successful.
2025-10-26 22:34:55 - agents.nodes.generate_routine - INFO - Successfully generated and validated routine in 0.01 seconds.
2025-10-26 22:34:55 - agents.nodes.generate_routine - INFO - --- Exiting Generate Routine Node ---
2025-10-26 22:34:55 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 22:34:55 - agents.nodes.generate_routine - ERROR - 'principios_libro' missing in state.
2025-10-26 22:34:55 - agents.nodes.generate_routine - INFO - --- Entering Generate Routine Node ---
2025-10-26 22:34:55 - agents.nodes.generate_routine - INFO - Loading routine assembler prompt from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\routine_assembler.txt
2025-10-26 22:34:55 - agents.nodes.generate_routine - INFO - Routine generation chain built.
2025-10-26 22:34:55 - agents.nodes.generate_routine - INFO - Attempt 1/3 to generate routine...
2025-10-26 22:34:55 - agents.nodes.generate_routine - ERROR - Attempt 1 failed with unexpected error: LLM Error simulado
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
Exception: LLM Error simulado
2025-10-26 22:34:56 - agents.nodes.generate_routine - INFO - Attempt 2/3 to generate routine...
2025-10-26 22:34:56 - agents.nodes.generate_routine - ERROR - Attempt 2 failed with unexpected error: LLM Error simulado
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
Exception: LLM Error simulado
2025-10-26 22:34:57 - agents.nodes.generate_routine - INFO - Attempt 3/3 to generate routine...
2025-10-26 22:34:57 - agents.nodes.generate_routine - ERROR - Attempt 3 failed with unexpected error: LLM Error simulado
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\generate_routine.py", line 143, in generate_routine
    generated_routine = chain.invoke(prompt_variables)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3093, in invoke
    input_ = context.run(step.invoke, input_, config)
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\tests\conftest.py", line 331, in mock_invoke
    raise error
Exception: LLM Error simulado
2025-10-26 22:34:58 - agents.nodes.generate_routine - ERROR - Failed to generate valid routine after 3 attempts.
2025-10-26 22:34:58 - agents.nodes.save_routine - INFO - --- Entering Save Routine Node ---
2025-10-26 22:34:58 - agents.nodes.save_routine - INFO - Attempting to save routine for user test_user to C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-5\test_guarda_rutina_exitosament0\users\test_user.json
2025-10-26 22:34:58 - agents.nodes.save_routine - INFO - Created backup at: C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-5\test_guarda_rutina_exitosament0\users\test_user.20251026223458.backup
2025-10-26 22:34:58 - agents.nodes.save_routine - INFO - Successfully wrote updated data to C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-5\test_guarda_rutina_exitosament0\users\test_user.json
2025-10-26 22:34:58 - agents.nodes.save_routine - INFO - Post-write verification passed.
2025-10-26 22:34:58 - agents.nodes.save_routine - INFO - --- Exiting Save Routine Node ---
2025-10-26 22:34:58 - agents.nodes.save_routine - INFO - --- Entering Save Routine Node ---
2025-10-26 22:34:58 - agents.nodes.save_routine - ERROR - 'rutina_final' missing or None in state.
2025-10-26 22:34:58 - agents.nodes.save_routine - INFO - --- Entering Save Routine Node ---
2025-10-26 22:34:58 - agents.nodes.save_routine - INFO - Attempting to save routine for user test_user to C:\Users\Usuario\AppData\Local\Temp\pytest-of-Usuario\pytest-5\test_maneja_error_io0\users\test_user.json
2025-10-26 22:34:58 - agents.nodes.save_routine - ERROR - File system error saving routine for test_user: Error de permisos simulado
Traceback (most recent call last):
  File "C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\agents\nodes\save_routine.py", line 62, in save_routine
    with open(user_file_path, "r", encoding="utf-8") as f:
         ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python313\Lib\unittest\mock.py", line 1169, in __call__
    return self._mock_call(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python313\Lib\unittest\mock.py", line 1173, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\Usuario\AppData\Local\Programs\Python\Python313\Lib\unittest\mock.py", line 1228, in _execute_mock_call
    raise effect
OSError: Error de permisos simulado
2025-10-26 22:34:58 - agents.nodes.save_routine - INFO - --- Exiting Save Routine Node ---
2025-10-26 22:34:58 - agents.nodes.handle_error - INFO - --- Entering Handle Error Node ---
2025-10-26 22:34:58 - agents.nodes.handle_error - ERROR - Error captured in step 'paso_anterior_fallo': Usuario 'xyz' no encontrado
2025-10-26 22:34:58 - agents.nodes.handle_error - INFO - Generated user-friendly error message:  Lo siento, hubo un problema: Ocurri un error inesperado procesando tu solicitud.
(Referencia: paso 'paso_anterior_fallo')
2025-10-26 22:34:58 - agents.nodes.handle_error - INFO - --- Exiting Handle Error Node ---
2025-10-26 22:34:58 - agents.nodes.handle_error - INFO - --- Entering Handle Error Node ---
2025-10-26 22:34:58 - agents.nodes.handle_error - ERROR - Error captured in step 'paso_anterior_fallo': Archivo corrupto para usuario 'abc': Unterminated string
2025-10-26 22:34:58 - agents.nodes.handle_error - INFO - Generated user-friendly error message:  Lo siento, hubo un problema: Hubo un problema al leer los datos de tu perfil. Podra estar corrupto.
(Referencia: paso 'paso_anterior_fallo')
2025-10-26 22:34:58 - agents.nodes.handle_error - INFO - --- Exiting Handle Error Node ---
2025-10-26 22:34:58 - agents.nodes.handle_error - INFO - --- Entering Handle Error Node ---
2025-10-26 22:34:58 - agents.nodes.handle_error - ERROR - Error captured in step 'paso_anterior_fallo': Alucinacin detectada: principios extrados sin citas
2025-10-26 22:34:58 - agents.nodes.handle_error - INFO - Generated user-friendly error message:  Lo siento, hubo un problema: No pude verificar la informacin extrada del libro (faltan citas). No puedo proceder de forma segura.
(Referencia: paso 'paso_anterior_fallo')
2025-10-26 22:34:58 - agents.nodes.handle_error - INFO - --- Exiting Handle Error Node ---
2025-10-26 22:34:58 - agents.nodes.handle_error - INFO - --- Entering Handle Error Node ---
2025-10-26 22:34:58 - agents.nodes.handle_error - ERROR - Error captured in step 'paso_anterior_fallo': Validacin fallida: RIR inconsistente
2025-10-26 22:34:58 - agents.nodes.handle_error - INFO - Generated user-friendly error message:  Lo siento, hubo un problema: La rutina generada no parece cumplir con los principios o tus preferencias.
(Referencia: paso 'paso_anterior_fallo')
2025-10-26 22:34:58 - agents.nodes.handle_error - INFO - --- Exiting Handle Error Node ---
2025-10-26 22:34:58 - agents.nodes.handle_error - INFO - --- Entering Handle Error Node ---
2025-10-26 22:34:58 - agents.nodes.handle_error - ERROR - Error captured in step 'paso_anterior_fallo': Error de archivo guardando rutina: [Errno 13] Permission denied
2025-10-26 22:34:58 - agents.nodes.handle_error - INFO - Generated user-friendly error message:  Lo siento, hubo un problema: Hubo un problema al intentar guardar la rutina en tu perfil.
(Referencia: paso 'paso_anterior_fallo')
2025-10-26 22:34:58 - agents.nodes.handle_error - INFO - --- Exiting Handle Error Node ---
2025-10-26 22:34:58 - agents.nodes.handle_error - INFO - --- Entering Handle Error Node ---
2025-10-26 22:34:58 - agents.nodes.handle_error - ERROR - Error captured in step 'paso_anterior_fallo': Error desconocido criptogrfico
2025-10-26 22:34:58 - agents.nodes.handle_error - INFO - Generated user-friendly error message:  Lo siento, hubo un problema: Ocurri un error inesperado procesando tu solicitud.
(Referencia: paso 'paso_anterior_fallo')
2025-10-26 22:34:58 - agents.nodes.handle_error - INFO - --- Exiting Handle Error Node ---
2025-10-26 22:34:58 - agents.nodes.load_context - INFO - --- Entering Load Context Node ---
2025-10-26 22:34:58 - agents.nodes.load_context - INFO - Attempting to load user profile from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\data\users\test_user.json
2025-10-26 22:34:58 - agents.nodes.load_context - ERROR - User file not found for user_id: test_user at C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\data\users\test_user.json
2025-10-26 22:34:58 - agents.nodes.handle_error - INFO - --- Entering Handle Error Node ---
2025-10-26 22:34:58 - agents.nodes.handle_error - ERROR - Error captured in step '': Error simulado para prueba de handle_error
2025-10-26 22:34:58 - agents.nodes.handle_error - INFO - Generated user-friendly error message:  Lo siento, hubo un problema: Ocurri un error inesperado procesando tu solicitud.
(Referencia: paso '')
2025-10-26 22:34:58 - agents.nodes.handle_error - INFO - --- Exiting Handle Error Node ---
2025-10-26 22:34:59 - rag.vectorstore_manager - INFO - Loading existing vector store from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\data\chroma_db
2025-10-26 22:35:01 - rag.vectorstore_manager - INFO -  Vector store loaded successfully.
2025-10-26 22:35:03 - rag.principle_extractor - INFO - PrincipleExtractor initialized.
2025-10-26 22:35:03 - rag.principle_extractor - INFO - Building the principle extraction RAG chain...
2025-10-26 22:35:03 - rag.principle_extractor - INFO - Loading prompt template from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\rag_principle_extractor.txt
2025-10-26 22:35:03 - rag.principle_extractor - INFO - Prompt template loaded successfully.
2025-10-26 22:35:03 - rag.vectorstore_manager - INFO - Loading existing vector store from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\data\chroma_db
2025-10-26 22:35:03 - rag.vectorstore_manager - INFO -  Vector store loaded successfully.
2025-10-26 22:35:03 - rag.principle_extractor - INFO - Retriever obtained from vector store.
2025-10-26 22:35:03 - rag.principle_extractor - INFO - PromptTemplate instance created.
2025-10-26 22:35:03 - rag.principle_extractor - INFO -  Principle extraction RAG chain built successfully.
2025-10-26 22:35:04 - rag.principle_extractor - INFO - PrincipleExtractor initialized.
2025-10-26 22:35:04 - rag.principle_extractor - INFO - Building the principle extraction RAG chain...
2025-10-26 22:35:04 - rag.principle_extractor - INFO - Loading prompt template from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\rag_principle_extractor.txt
2025-10-26 22:35:04 - rag.principle_extractor - INFO - Prompt template loaded successfully.
2025-10-26 22:35:04 - rag.vectorstore_manager - INFO - Loading existing vector store from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\data\chroma_db
2025-10-26 22:35:04 - rag.vectorstore_manager - INFO -  Vector store loaded successfully.
2025-10-26 22:35:04 - rag.principle_extractor - INFO - Retriever obtained from vector store.
2025-10-26 22:35:04 - rag.principle_extractor - INFO - PromptTemplate instance created.
2025-10-26 22:35:04 - rag.principle_extractor - INFO -  Principle extraction RAG chain built successfully.
2025-10-26 22:35:05 - rag.principle_extractor - INFO - PrincipleExtractor initialized.
2025-10-26 22:35:05 - rag.principle_extractor - INFO - Building the principle extraction RAG chain...
2025-10-26 22:35:05 - rag.principle_extractor - INFO - Loading prompt template from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\rag_principle_extractor.txt
2025-10-26 22:35:05 - rag.principle_extractor - INFO - Prompt template loaded successfully.
2025-10-26 22:35:05 - rag.vectorstore_manager - INFO - Loading existing vector store from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\data\chroma_db
2025-10-26 22:35:05 - rag.vectorstore_manager - INFO -  Vector store loaded successfully.
2025-10-26 22:35:05 - rag.principle_extractor - INFO - Retriever obtained from vector store.
2025-10-26 22:35:05 - rag.principle_extractor - INFO - PromptTemplate instance created.
2025-10-26 22:35:05 - rag.principle_extractor - INFO -  Principle extraction RAG chain built successfully.
2025-10-26 22:35:06 - rag.principle_extractor - INFO - PrincipleExtractor initialized.
2025-10-26 22:35:06 - rag.principle_extractor - INFO - Building the principle extraction RAG chain...
2025-10-26 22:35:06 - rag.principle_extractor - INFO - Loading prompt template from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\rag_principle_extractor.txt
2025-10-26 22:35:06 - rag.principle_extractor - INFO - Prompt template loaded successfully.
2025-10-26 22:35:06 - rag.vectorstore_manager - INFO - Loading existing vector store from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\data\chroma_db
2025-10-26 22:35:06 - rag.vectorstore_manager - INFO -  Vector store loaded successfully.
2025-10-26 22:35:06 - rag.principle_extractor - INFO - Retriever obtained from vector store.
2025-10-26 22:35:06 - rag.principle_extractor - INFO - PromptTemplate instance created.
2025-10-26 22:35:06 - rag.principle_extractor - INFO -  Principle extraction RAG chain built successfully.
2025-10-26 22:35:07 - rag.principle_extractor - INFO - PrincipleExtractor initialized.
2025-10-26 22:35:07 - rag.principle_extractor - INFO - Building the principle extraction RAG chain...
2025-10-26 22:35:07 - rag.principle_extractor - INFO - Loading prompt template from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\prompts\rag_principle_extractor.txt
2025-10-26 22:35:07 - rag.principle_extractor - INFO - Prompt template loaded successfully.
2025-10-26 22:35:07 - rag.vectorstore_manager - INFO - Loading existing vector store from: C:\Users\Usuario\Documents\UTEC\Agente Entrenador con tools\data\chroma_db
2025-10-26 22:35:07 - rag.vectorstore_manager - INFO -  Vector store loaded successfully.
2025-10-26 22:35:07 - rag.principle_extractor - INFO - Retriever obtained from vector store.
2025-10-26 22:35:07 - rag.principle_extractor - INFO - PromptTemplate instance created.
2025-10-26 22:35:07 - rag.principle_extractor - INFO -  Principle extraction RAG chain built successfully.
